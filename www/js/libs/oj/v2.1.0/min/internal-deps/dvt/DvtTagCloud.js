/**
 * Copyright (c) 2014, 2016, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(['./DvtToolkit'], function(dvt) {
  // Internal use only.  All APIs and functionality are subject to change at any time.

var l=void 0,n=!0,s=null,t=!1;function aa(){return function(a){return a}}function y(){return function(){}}function z(a){return function(b){this[a]=b}}function D(a){return function(){return this[a]}}function F(a){return function(){return a}}var J;function ba(a,b){0==a.indexOf("dvt.")&&(a=a.substring(4));var c=a.split("."),d=eval("dvt");!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&b!==l?d[e]=b:d=d[e]?d[e]:d[e]={}}Math.floor(2147483648*Math.random()).toString(36);
dvt.Je=function(a,b,c){this.Init(a,b,c)};ba("dvt.TagCloud",dvt.Je);dvt.j.u(dvt.Je,dvt.af);dvt.Je.newInstance=function(a,b,c){return new dvt.Je(a,b,c)};dvt.Je.newInstance=dvt.Je.newInstance;dvt.Je.prototype.Init=function(a,b,c){dvt.Je.q.Init.call(this,a,b,c);this.g().we.hb().setAttributeNS(s,"text-rendering","geometricPrecision");this.K=new Ys(this,a,this.If,this);this.K.Bg(this);dvt.o.Ta()||this.K.ns(new Zs(this.K));this.Dh=new $s;this.bc=[];this.Tu=[];this.Hj=s;this.Bf=new dvt.Hg(this.g());this.K.qU(this.Bf)};
dvt.Je.prototype.ua=function(a,b,c){!isNaN(b)&&!isNaN(c)&&(this.yb=b,this.Lb=c);this.nW();this.Nf(a);this.Ob&&this.Ob.stop();this.xj=this.ya;this.zY=this.bc;this.bc=[];this.oCa=[];this.ya=new dvt.ca(this.g());this.k(this.ya);at.ua(this,this.ya,new dvt.U(0,0,this.yb,this.Lb));this.Sc&&this.Sc.Lt(this.T.selection,this.jv());b=this.T.animationDuration;c=new dvt.U(0,0,this.yb,this.Lb);this.xj?"none"!==this.T.animationOnDataChange&&a&&(this.vh=new dvt.ca(this.g()),this.k(this.vh),a=new dvt.up(this.g(),
this.vh),a.Tp(this.zY,this.bc),this.Ob=a.dv()):"none"!==this.T.animationOnDisplay&&(this.Ob=dvt.cc.mD(this.g(),dvt.cc.rB,this.ya,c,b));this.Ob?(this.K.he(),this.K.$k(this),this.Ob.Qf(this.zua,this),this.Ob.play()):this.zua();this.nr()};dvt.Je.prototype.render=dvt.Je.prototype.ua;dvt.Je.prototype.Vpa=z("bc");dvt.Je.prototype.ni=function(){this.Ud||(this.Ud=new bt(this));return this.Ud};dvt.Je.prototype.getAutomation=dvt.Je.prototype.ni;
dvt.Je.prototype.hK=function(a,b){this.Tu.push(a);this.oCa[b]=a};dvt.Je.prototype.jv=D("Tu");dvt.Je.prototype.uk=D("oCa");dvt.Je.prototype.Me=function(a){this.T.highlightedCategories=dvt.Ac.Ca(a);dvt.Sg.Me(a,this.jv(),"any"===this.T.highlightMatch);this.Hj&&this.Hj.Me(a)};dvt.Je.prototype.highlight=dvt.Je.prototype.Me;dvt.Je.prototype.select=function(a){this.T.selection=dvt.Ac.Ca(a);this.Sc&&this.Sc.Lt(this.T.selection,this.jv())};dvt.Je.prototype.select=dvt.Je.prototype.select;J=dvt.Je.prototype;
J.Nf=function(a){a?this.T=this.Dh.cn(a):this.T||(this.T=this.UD());a=this.T.selectionMode;this.Sc="single"===a?new dvt.Sc(dvt.Sc.Az):"multiple"===a?new dvt.Sc(dvt.Sc.xz):s;this.K.nB(this.Sc);dvt.o.Wi()||(this.T.animationOnDisplay="none",this.T.animationOnDataChange="none")};J.Km=function(){return dvt.D.bh(this.v(),"componentName",dvt.D.Ka,"TAG_CLOUD")};
J.zua=function(){this.xj&&(this.removeChild(this.xj),this.xj.ra(),this.xj=s);this.vh&&(this.removeChild(this.vh),this.vh.ra(),this.vh=s);this.Ob&&(this.Ob=s,this.K.Bg(this));this.T.highlightedCategories&&0<this.T.highlightedCategories.length&&this.Me(this.T.highlightedCategories)};J.nW=function(){this.K.he();this.Tu.length=0};J.Ua=D("K");
J.If=function(a,b){var c=a.type;if("categoryHide"==c||"categoryShow"==c){var d=a.category,e=dvt.ea.jb(this.T.hiddenCategories,d);"categoryHide"==c&&0>e&&this.T.hiddenCategories.push(d);"categoryShow"==c&&0<=e&&this.T.hiddenCategories.splice(e,1);this.ua(this.T,this.yb,this.Lb)}else"categoryHighlight"==c&&(this!=b?this.Me(a.categories):this.Hj&&this.Hj!=b&&this.Hj.If(a,b));a&&this.dispatchEvent(a)};J.KA=function(){for(var a=[],b=this.Sc.getSelection(),c=0;c<b.length;c++)a=a.concat(b[c].Ue());return a};
J.en=function(a,b,c){return this.Bf.en(c)};dvt.Je.prototype.isDragAvailable=dvt.Je.prototype.en;dvt.Je.prototype.so=function(a,b){return this.Bf.so(a,b)};dvt.Je.prototype.getDragTransferable=dvt.Je.prototype.so;dvt.Je.prototype.Ny=function(a,b){return this.Bf.Ny(a,b)};dvt.Je.prototype.getDragOverFeedback=dvt.Je.prototype.Ny;dvt.Je.prototype.wt=function(a,b){return this.Bf.wt(a,b)};dvt.Je.prototype.getDragContext=dvt.Je.prototype.wt;dvt.Je.prototype.LA=function(a,b){return this.Bf.LA(a,b)};
dvt.Je.prototype.getDragOffset=dvt.Je.prototype.LA;dvt.Je.prototype.SA=function(a,b){return this.Bf.SA(a,b)};dvt.Je.prototype.getPointerOffset=dvt.Je.prototype.SA;dvt.Je.prototype.YA=function(){this.Bf.YA()};dvt.Je.prototype.initiateDrag=dvt.Je.prototype.YA;dvt.Je.prototype.Fw=function(){this.Bf.Fw()};dvt.Je.prototype.dragDropEnd=dvt.Je.prototype.Fw;dvt.Je.prototype.Nr=function(a,b,c){this.Po||(this.Po=new ct);return this.Po.Nr(a,b,c)};dvt.Je.prototype.acceptDrag=dvt.Je.prototype.Nr;
function bt(a){this.YC=a}ba("DvtTagCloudAutomation",bt);dvt.j.u(bt,dvt.Ud);bt.prototype.Ho=function(a){return(a=this.YC.K.bb(a))&&a instanceof dt?"item["+this.YC.uk().indexOf(a)+"]":s};bt.prototype.pi=function(a){if(a==dvt.Ud.OB)return this.XD(this.YC);var b=a.indexOf("[");return 0<b&&"item"===a.substring(0,b)&&(a=parseInt(a.substring(b+1,a.length-1)),a=this.YC.uk()[a])?a.Ue()[0].hb():s};bt.prototype.getDomElementForSubId=bt.prototype.pi;
bt.prototype.getItem=function(a){if(a=this.YC.uk()[a]){var b={};b.color=a.cm();b.tooltip=a.ge();b.label=a.Ae();b.value=a.getValue();b.selected=a.sb();return b}return s};bt.prototype.getItem=bt.prototype.getItem;bt.prototype.wT=function(){return this.YC.jv().length};bt.prototype.getItemCount=bt.prototype.wT;function et(a,b,c,d,e,f,h){this.Init(a,b,c,d,e,f,h)}dvt.j.u(et,dvt.qe);J=et.prototype;J.Init=function(a,b,c,d,e,f,h){et.q.Init.call(this,b,c,d,e,f,h);this.YC=a;this.D8();f&&ft(this,f)};
J.pc=function(a){this.kl!=a&&((this.kl=a)?this.So?this.zb(this.V5):this.zb(this.K7):this.zb(this.SM))};J.rd=function(){this.So||(this.So=n,this.kl?this.zb(this.V5):this.zb(this.wia))};J.Qc=function(){this.kl?this.zb(this.K7):this.zb(this.SM);this.So=t};
J.oh=function(a,b){var c=new dvt.Nd(this.g(),this,gt.lb(this.YC)),d=this.Hd(),e=b.Hd(),f=t,h=e.I(dvt.e.hc),k=d.I(dvt.e.hc);if(h!=k){var m=this;this.zb(d.oa(dvt.e.hc,h));c.da.J(dvt.B.Zva,this,function(){return m.Hd().I(dvt.e.hc)},function(a){m.zb(m.Hd().oa(dvt.e.hc,a))},k)}e=parseFloat(e.I(dvt.e.Yi));d=parseFloat(d.I(dvt.e.Yi));e!=d&&(f=n,m=this,this.Fg(e),c.da.J(dvt.B.Q,this,function(){return parseFloat(m.Hd().I(dvt.e.Yi))},this.Fg,d));d=b.Sa();e=this.Sa();h=b.Oq();k=this.Oq();if(e!=d||f&&k!=h)k!=
h&&(d=ht(b,d,h)),this.Ia(d),c.da.J(dvt.B.Q,this,this.Sa,this.Ia,e);f=b.Za();d=this.Za();d!=f&&(this.ib(f),c.da.J(dvt.B.Q,this,this.Za,this.ib,d));b.P(0);a.add(c,1)};J.Vj=function(a){a.add(new dvt.Ij(this.g(),this,gt.lb(this.YC)),0)};J.Si=function(a){this.P(0);a.add(new dvt.Ch(this.g(),this,gt.lb(this.YC)),2)};J.Fg=function(a){et.q.Fg.call(this,a);ft(this,this.Hd())};
function ft(a,b){a.SM=b.Ca();var c=a.SM.I(dvt.e.hc);a.SM.oa(dvt.e.Gb,s);a.wia=a.SM.Ca();var d=it(c,0.3);a.wia.oa(dvt.e.Gb,d);a.wia.oa(dvt.e.hc,dvt.H.vm(d));a.K7=a.SM.Ca();a.K7.oa(dvt.e.Gb,c);a.K7.oa(dvt.e.hc,dvt.H.vm(c));a.V5=a.SM.Ca();c=it(c,0.6);a.V5.oa(dvt.e.Gb,c);a.V5.oa(dvt.e.hc,dvt.H.vm(c))}function ht(a,b,c){a=a.i9a();return c==dvt.ba.iq?b+a.a:c==dvt.ba.Lm?b-a.a:b}
function it(a,b){var c=dvt.H.ug(a),d=dvt.H.sg(a),e=dvt.H.rg(a);return dvt.H.CG(Math.floor(255*(1-b)+b*c),Math.floor(255*(1-b)+b*d),Math.floor(255*(1-b)+b*e))}function dt(a,b,c){this.Init(a,b,c)}dvt.j.u(dt,dvt.j);J=dt.prototype;J.Init=function(a,b,c){this.X=a;this.aj=b;this.Sb=c;this.JL=this.kl=t;c.url?(b.Pf("link"),this.sja=dvt.F.JJ("_blank",c.url)):b.Pf("img");this.Zu()};J.getId=function(){return this.Sb.id};J.Ae=function(){return this.Sb.label};J.getValue=function(){return this.Sb.value};J.ge=function(){return this.Sb.shortDesc};
J.Cg=function(){return this.Sb.action};J.Pg=function(){var a=this.X.v().tooltip;return a?this.X.g().fg().JA(a,this.Ur()):this.ge()};J.Ur=function(){return{id:this.getId(),label:this.Ae(),color:this.cm(),value:this.getValue()}};J.JJ=D("sja");J.cm=function(){this.zr||(this.zr=(new dvt.e(this.Sb.style)).I(dvt.e.hc));return this.zr};J.bi=z("JL");J.mb=D("JL");J.sb=D("kl");J.pc=function(a){this.kl=a;this.aj.pc(a);this.Zu()};J.rd=function(){this.aj.rd()};J.Qc=function(){this.aj.Qc()};
J.pe=function(a){var b=this.X.K.Ab;a.type==dvt.pa.He||b.qv(a)?b=this:b.Xi(a)?(b=this.X.jv(),a=a.keyCode==dvt.G.mg||a.keyCode==dvt.G.xg?n:t,a=dvt.ea.jb(b,this)+(a?1:-1),b=a<b.length&&0<=a?b[a]:s):b=s;return b};J.Dg=function(a){return this.aj.V(a)};J.Bm=function(){return this.aj.hb()};J.Rf=function(){this.$c=n;this.rd()};J.Md=function(){this.$c&&(this.$c=t,this.Qc())};J.Od=D("$c");J.Ue=function(){return[this.aj]};
J.Gd=function(){var a=[];this.mb()&&a.push(dvt.D.na(dvt.D.Ka,this.sb()?"STATE_SELECTED":"STATE_UNSELECTED"));return dvt.ja.sk(this.ge(),a)};J.ze=function(){return this.Sb.categories};J.Zu=function(){dvt.o.Fi()||this.aj.zd("label",this.Gd())};J.nf=function(){if(!this.lf&&(this.lf=[],this.Sb.showPopupBehaviors))for(var a=this.Sb.showPopupBehaviors,b=0;b<a.length;b++)this.lf.push(new dvt.Nc(a[b].popupId,a[b].triggerType,a[b].alignId,a[b].align));return this.lf};
J.en=function(a){return this.X.Sc?a[0]:s};J.so=function(){var a=this.X;this.sb()||(a.Sc.eq(this,t),a.K.bG());for(var b=[],a=a.Sc.getSelection(),c=0;c<a.length;c++){var d=a[c];d instanceof dt&&b.push(d.getId())}return b};J.KA=function(){return this.X.KA()};function $s(){this.Init({alta:jt})}dvt.j.u($s,dvt.fm);
var jt={animationOnDisplay:"none",animationOnDataChange:"none",emptyText:s,hiddenCategories:[],hideAndShowBehavior:"none",highlightedCategories:[],highlightMatch:"all",hoverBehavior:"none",layout:"rectangular",selectionMode:"none",_statusMessageStyle:new dvt.e('font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; color: #333333;'),styleDefaults:{animationDuration:500,hoverBehaviorDelay:200,style:new dvt.e('font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; color: #333333;')},touchResponse:"auto"},
at={};dvt.j.u(at,dvt.j);at.ua=function(a,b,c){at.wy(a,b,c);at.fJ(a,b,c);at.XB(c);var d=a.v();d.items&&0<d.items.length?(d=at.Mka(a,b,c),0<d.length?(a.Vpa(d),a.K.ms(a.jv()[0])):at.gZ(a,b,c)):at.gZ(a,b,c)};at.gZ=function(a,b,c){var d=a.v(),e=d.emptyText;e||(e=dvt.D.bh(d,"labelNoData",dvt.D.Ka,"NO_DATA",s));dvt.Aa.fq(b,e,new dvt.U(c.x,c.y,c.a,c.b),a.K,d._statusMessageStyle)};at.wy=function(a,b,c){a=new dvt.ka(a.g(),c.x,c.y,c.a,c.b);a.gc();b.k(a)};
at.Mka=function(a,b,c){for(var d=a.v(),e=[],f=d.items,h=Number.MAX_VALUE,k=-Number.MAX_VALUE,m=0;m<f.length;m++)h=Math.min(h,f[m].value),k=Math.max(k,f[m].value);h=kt.y7a(h,k);k=dvt.ea.MN(d.hiddenCategories);for(m=0;m<f.length;m++){var p=f[m];p.categories||(p.categories=[p.label]);if(!k||!dvt.ea.UT(k,p.categories)){var q=d.styleDefaults.style.Ca(),r=p.color;r&&q.oa(dvt.e.hc,r);q.$h(p.style);q.oa(dvt.e.Yi,h.call(s,p.value).toString());q=new et(a,a.g(),p.label,0,0,q,p.id);r=new dt(a,q,p);a.K.qb(q,r);
a.hK(r,m);"none"!==d.selectionMode&&r.bi(n);(r.mb()||p.url||r.Cg())&&q.setCursor("pointer");e.push(q);b.k(q)}}0<e.length&&("cloud"===d.layout?kt.$4a(c,e):kt.Vab(c,e,dvt.o.$(a.g())));return e};
at.fJ=function(a,b,c){var d=a.v(),e=d.legend;if(e&&e.sections){e=dvt.Ac.Ca(e);e.orientation="horizontal";e.halign="center";e.hoverBehavior=d.hoverBehavior;e.hideAndShowBehavior=d.hideAndShowBehavior;e.hiddenCategories=d.hiddenCategories;d=dvt.pf.newInstance(a.g(),a.If,a);b.k(d);var f=d.Yr(e,c.a,c.b/3);d.ua(e,f.a,f.b);dvt.jq.position(c,"bottom",d,f.a,f.b,0);a.Hj&&(a.Hj.ra(),b.removeChild(a.Hj));a.Hj=d}};at.XB=function(a){a.x=Math.round(a.x);a.y=Math.round(a.y);a.a=Math.round(a.a);a.b=Math.round(a.b)};
function kt(){}dvt.j.u(kt,dvt.j);kt.y7a=function(a,b){return function(c){return 12+Math.ceil(12*(2*(c-a)/(b-a)))}};
kt.$4a=function(a,b){var c=[],d=10/180,e=10/180;a.a>a.b?d*=a.a/a.b:e*=a.b/a.a;for(var f=2*Math.PI/180,h=s,k=0,m=[],p=[],q=0;q<b.length;q++)for(var r=t,u=0,v=4,w=b[q],x=w.V(),k=Math.max(k,parseFloat(w.Hd().I(dvt.e.Yi))),B=-1;!r;){var A=u%180;m[A]===l&&(m[A]=Math.cos(u*f));p[A]===l&&(p[A]=Math.sin(u*f));var C=d*u*m[A],E=e*u*p[A],H=new dvt.U(C,E,x.a,x.b),r=n;-1!=B&&c[B].Poa(H)&&(r=t);if(r)for(A=0;A<q;A++)if(c[A].Poa(H)){B=A;r=t;break}r&&(h=h?h.Fj(H):H,B=-1,c[q]=H,w.Ia(C),w.ib(-x.y+E));3600===u?v=3:5400===
u?v=2:10800===u&&(v=1);u+=v}c=Math.max(h.a/a.a,h.b/a.b);d=h.x+h.a/2;h=h.y+h.b/2;for(A=0;A<b.length;A++)w=b[A],w.Ia(a.x+w.Sa()/c+(a.a/2-d/c)),w.ib(a.y+w.Za()/c+(a.b/2-h/c)),e=parseFloat(w.Hd().I(dvt.e.Yi)),w.Fg(e/c)};
kt.Vab=function(a,b,c){for(var d=[],e=0,f=0,h=0,k=0;k<b.length;k++){var m=b[k],p=m.V(),e=Math.max(e,p.a),f=Math.max(f,p.b),h=Math.max(h,parseFloat(m.Hd().I(dvt.e.Yi)));d.push(new dvt.$j(p.a,p.b))}k=0;for(m=(a.a-10)/e;0.001<m-k;)e=(k+m)/2,h=kt.Qya(d,(a.a-10)/e),h.length*(e*f+2)-2>a.b-10?m=e:k=e;e=k;h=kt.Qya(d,(a.a-10)/e);h.push(b.length);for(k=0;k<h.length-1;k++){var p=h[k],q=h[k+1],r=0,u=0,v=n;if(1<q-p){for(var m=0,w=p;w<q;w++)m+=d[w].a*e,u=Math.max(u,d[w].b*e);r=(a.a-10-m)/(q-p-1);k==h.length-2&&
(w=0.5*u,w<r&&m+(q-p)*w<0.9*(a.a-10)&&(r=w,v=t))}for(var u=5+(k+1)*(f*e+2)-2,x=c?a.a-5:5,w=p;w<q;w++){var m=b[w],B=parseFloat(m.Hd().I(dvt.e.Yi));m.Fg(B*e);m.ib(a.y+u);v&&w==q-1&&w!=p?c?(m.pk(),m.Ia(a.x+5)):(m.qk(),m.Ia(a.x+a.a-5)):(m.Ia(a.x+x),c?(m.qk(),x-=d[w].a*e+r):(m.pk(),x+=d[w].a*e+r))}}};kt.Qya=function(a,b){var c=[0],d=a[0].a+2;if(1<a.length)for(var e=1;e<a.length;e++)d+a[e].a>b&&(c.push(e),d=0),d+=a[e].a+2;return c};var gt={};dvt.j.u(gt,dvt.j);
gt.lb=function(a){return a.v().styleDefaults.animationDuration/1E3};function Ys(a,b,c,d){this.Init(b,c,d);this.X=a}dvt.j.u(Ys,dvt.K);J=Ys.prototype;J.KP=function(a){a=this.bb(a.target);lt(a);this.lN(a)};J.zV=function(a){a=this.bb(a.target);this.lN(a)};J.Hv=function(a){a=this.bb(a.target);lt(a);this.lN(a)};function lt(a){a instanceof dt&&(a=a.JJ())&&a.call()}J.Ek=function(a){var b=n,c=this.Ye();a.keyCode==dvt.G.vi?lt(c):b=Ys.q.Ek.call(this,a);return b};
J.yp=function(a,b,c){a=this.X.v();"dim"==a.hoverBehavior&&(b=b.ze?b.ze():[],a.highlightedCategories=c?b.slice():s,c=dvt.Wa.EG(a.highlightedCategories,c),b=dvt.Qa.cs(a.styleDefaults.hoverBehaviorDelay),this.wH.If(c,this.X.jv(),b,"any"==a.highlightMatch))};J.lN=function(a){a&&(a.Cg&&a.Cg())&&this.Ck(dvt.Wa.DG("action",a.Cg(),a.getId()))};J.sz=function(){return this.X.v().touchResponse};function Zs(a){this.Init(a)}dvt.j.u(Zs,dvt.Ab);Zs.prototype.Init=function(a){Zs.q.Init.call(this,a)};
Zs.prototype.yD=function(a){return this.Xi(a)&&!a.ctrlKey};Zs.prototype.qv=function(a){return a.keyCode==dvt.G.wi&&a.ctrlKey};function ct(){}dvt.j.u(ct,dvt.$G);ct.prototype.Nr=function(a,b,c){return c[0]};
  return dvt;
});
