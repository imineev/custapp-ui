/**
 * Copyright (c) 2014, 2016, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
/*
 Copyright 2013 jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
*/
define(["ojs/ojcore","jquery","ojs/ojcomponentcore"],function(b,f){(function(){b.Ja("oj.ojTrain",f.oj.baseComponent,{version:"1.0.0",defaultElement:"\x3cdiv\x3e",widgetEventPrefix:"oj",options:{steps:[],selected:"",optionChange:null,beforeDeselect:null,deselect:null,beforeSelect:null,select:null},og:0,Zb:null,_ComponentCreate:function(){this._super();this.z8()},z8:function(){var a=this.options,b=a.steps;this.og=b.length;this.wx=f("\x3cdiv class\x3d'oj-train-wrapper'\x3e\x3c/div\x3e");this.wx.appendTo(this.element);
this.nF=f("\x3cdiv class\x3d'oj-train-connector-wrapper'\x3e\x3c/div\x3e");this.nF.appendTo(this.wx);var c=this.element.attr("class");(this.U8=null!=c&&0<=c.indexOf("oj-train-stretch"))&&this.nF.css("padding","0 "+100/(2*this.og)+"%");this.z0=f("\x3cdiv class\x3d'oj-train-connector'\x3e\x3c/div\x3e");this.z0.appendTo(this.nF);this.ng=f("\x3cul\x3e");this.ng.addClass("oj-train-step-list");this.JN=f("\x3cdiv class\x3d'oj-train-connector-fill'\x3e\x3c/div\x3e");this.JN.appendTo(this.nF);this.Dva();this.xl=
this.Dw(a.selected);-1===this.xl&&b[0]&&b[0].id&&(this.xl=0,a.selected=b[0].id);for(a=0;a<this.og;a++)b=f("\x3cli\x3e").addClass("oj-train-step-list-item").attr({id:this.Zb[a][1]}),b.appendTo(this.ng),this.$la(a),this.cma(a),this.Zla(a),this.ama(a),this.U8&&b.css("width",100/this.og+"%");this.JN.css({width:(this.og-1===this.xl?100:100/(2*(this.og-1))+this.xl/(this.og-1)*100)+"%"});this.ng.appendTo(this.wx);this.element.addClass("oj-train")},Dva:function(){var a=this.options;this.Zb=[];for(var b=0;b<
this.og;b++){var c=a.steps[b];this.Zb[b]=Array(5);this.Zb[b][0]=c.label?c.label:null;this.Zb[b][1]=c.id?c.id:null;this.Zb[b][2]=c.disabled?!0:!1;this.Zb[b][3]=c.visited?!0:!1;this.Zb[b][4]=c.messageType?c.messageType:null}},Zla:function(a){var b=f("\x3cdiv/\x3e").addClass("oj-train-button"),c=f("\x3cspan/\x3e"),e=this,g="";if(this.Zb[a]){var h=this.Zb[a][3],k=this.Zb[a][2];this.xl===a?(b.addClass("oj-selected"),g=" current "):h&&!k?(b.addClass("oj-visited"),g=" visited "):h||k?b.addClass("oj-disabled"):
(b.addClass("oj-default"),g=" not visited ");this.Zb[a][2]||this.xl===a||(this._hoverable(b),b.on("click"+this.eventNamespace,function(a){e.RF("selected",e.options.selected,this.parentNode.parentNode.id,a);e.refresh()}));h=this.ng.children().eq(a).find(".oj-train-button-connector");1<=h.length&&h.children().remove();h.append(b);c.text(g);c.addClass("oj-helper-hidden-accessible");this.ng.children().eq(a).find("a").append(c)}},ama:function(a){var b=f("\x3cdiv/\x3e").addClass("oj-train-icon"),c=f("\x3cspan/\x3e"),
e="",g=this;if(this.Zb[a]){var h=this.Zb[a][4];"confirmation"===h?(b.addClass("oj-confirmation"),e=" Confirmation "):"info"===h?(b.addClass("oj-info"),e=" Info "):"error"===h?(b.addClass("oj-error"),e=" Error "):"fatal"===h?(b.addClass("oj-error"),e=" Error "):"warning"===h&&(b.addClass("oj-warning"),e=" Warning ");var k=this.ng.children().eq(a).find(".oj-train-button");1<=k.children().length&&k.children().remove();this.Zb[a][2]||this.xl===a||(this._hoverable(b),b.on("click"+this.eventNamespace,function(a){g.RF("selected",
g.options.selected,this.parentNode.parentNode.parentNode.id,a);g.refresh()}));null!=h&&(c.text(e),c.addClass("oj-helper-hidden-accessible"),this.ng.children().eq(a).find("a").append(c),k.append(b))}},RF:function(a,b,c,e){a={option:a,fromStep:this.getStep(b),toStep:this.getStep(c),optionMetadata:{writeback:e?"shouldWrite":"shouldNotWrite"}};!1!==this._trigger("beforeDeselect",e,a)&&!1!==this._trigger("beforeSelect",e,a)&&(b=this.Dw(b),-1!==b&&(this.options.steps[b].visited=!0),this._trigger("deselect",
e,a),this.option("selected",c,{_context:{originalEvent:e,lb:!0}}),this._trigger("select",e,a))},cma:function(a){var b=f("\x3cdiv/\x3e");b.addClass("oj-train-button-connector");this.Zb[a]&&(a<=this.xl&&b.addClass("oj-train-fill"),a=this.ng.children().eq(a).children(),b.insertBefore(a))},$la:function(a){var b=this;if(this.Zb[a]){var c=f("\x3cdiv/\x3e").addClass("oj-train-label-wrapper"),e=f("\x3ca\x3e");e.text(this.Zb[a][0]);var g=this.Zb[a][2];c.append(e);e.addClass("oj-train-label");a===this.xl?e.addClass("oj-selected"):
this.Zb[a][3]&&!g?e.addClass("oj-visited"):g&&e.addClass("oj-disabled");g||(e.attr("href","#"),this._hoverable(e),e.on("click keydown"+this.eventNamespace,function(a){if(a.keyCode===f.ui.keyCode.ENTER||"click"===a.type)a.preventDefault(),b.RF("selected",b.options.selected,this.parentNode.parentNode.id,a),b.refresh(),a.keyCode===f.ui.keyCode.ENTER&&b.Mm(this.parentNode.parentNode.id)}));e=this.ng.children().eq(a).children();1<=e.length&&e[0].remove();this.ng.children().eq(a).append(c)}},Dw:function(a){for(var b=
0;b<this.og;b++)if(this.Zb[b]&&this.Zb[b][1]===a)return b;return-1},getStep:function(a){for(var b=0;b<this.og;b++)if(this.Zb[b]&&this.Zb[b][1]===a)return jQuery.extend({},this.options.steps[b]);return null},nextSelectableStep:function(){for(var a=this.Dw(this.options.selected);a<this.og;a++)if(a+1<this.og&&this.Zb[a+1]&&!this.Zb[a+1][2])return this.Zb[a+1][1];return null},previousSelectableStep:function(){for(var a=this.Dw(this.options.selected);0<=a;a--)if(this.Zb[a-1]&&!this.Zb[a-1][2])return this.Zb[a-
1][1];return null},setStep:function(a){if(a.id){var b=this.getStep(a.id),c=this.Dw(a.id);-1!==c&&(c=this.options.steps[c],a.label&&(b[0]=a.label,c.label=a.label),"boolean"===typeof a.disabled&&(b[2]=a.disabled,c.disabled=a.disabled),"boolean"===typeof a.visited&&(b[3]=a.visited,c.visited=a.visited),a.messageType&&(b[4]=a.messageType,c.messageType=a.messageType));this.refresh()}},_setOptions:function(a){this._super(a);this.refresh()},_setOption:function(a,b,c){"selected"===a&&this.options.selected&&
this.Zb&&this.Zb[this.xl]&&this.RF("selected",this.Zb[this.xl][1],b,null);this._super(a,b,c)},refresh:function(){this._super();this._destroy();this.z8()},_destroy:function(){this.ng.children().each(function(){f(this).remove()});this.element.removeClass("oj-train");this.element.find(".oj-train-wrapper").remove();this.element.find(".oj-train-connector-wrapper").remove();this.element.find(".oj-train-step-list").remove();this.element.find(".oj-train-step-list").remove();this._super()},Mm:function(a){a=
this.Dw(a);for(var b=0;b<this.og;b++)if(this.Zb[(a+b+1)%this.og]&&!this.Zb[(a+b+1)%this.og][2]){this.ng.children().eq((a+b+1)%this.og).find(".oj-train-label").focus();break}},getNodeBySubId:function(a){if(null===a)return this.element?this.element[0]:null;var b=a.index;if("number"!==typeof b||0>b||b>=this.og)return null;switch(a.subId){case "oj-train-step":return this.ng.children().eq(b)[0];case "oj-train-button":return this.ng.children().eq(b).find(".oj-train-button")[0];case "oj-train-button-connector":return this.ng.children().eq(b).find(".oj-train-button-connector")[0];
case "oj-train-connector":return this.z0;case "oj-train-connector-fill":return this.JN;case "oj-train-icon":return this.ng.children().eq(b).find(".oj-train-icon")[0];case "oj-train-label":return this.ng.children().eq(b).find(".oj-train-label")[0]}return null},getSubIdByNode:function(a){for(var b=this.Zb?this.Zb.length:0,c=0;c<b;c++){var e={subId:"oj-train-step",index:c};if(a===this.getNodeBySubId(e))return e}return null}})})()});