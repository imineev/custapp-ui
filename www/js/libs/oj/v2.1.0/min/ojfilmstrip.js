/**
 * Copyright (c) 2014, 2016, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(["ojs/ojcore","jquery","ojs/ojcomponentcore","promise"],function(b,f){b.Me=function(){this.Init()};b.b.la(b.Me,b.ji,"oj.FilmStripPagingModel");b.Me.prototype.Init=function(){b.Me.p.Init.call(this);this.Hd=-1;this.rf=0;this.cb=-1};b.b.g("FilmStripPagingModel.prototype.Init",{Init:b.Me.prototype.Init});b.Me.prototype.ZBa=function(a){this.rf=a};b.Me.prototype.getPage=function(){return this.Hd};b.b.g("FilmStripPagingModel.prototype.getPage",{getPage:b.Me.prototype.getPage});b.Me.prototype.setPage=
function(a,b){a=parseInt(a,10);try{var c=this.getPageCount(),e=this.Hd,f=this.cb,h=f;b&&b.pageSize&&(h=b.pageSize);var k=Math.ceil(this.rf/h);if(0>a||a>k-1)throw Error("JET FilmStrip: Invalid 'page' set: "+a);var l=!1;if(a!=e||h!=f){if(!1===this.handleEvent("beforePage",{page:a,previousPage:e}))return Promise.reject();l=!0}this.Hd=a;this.cb=h;var p=this.getPageCount(),n=this;return new Promise(function(b){c!=p&&n.handleEvent("pageCount",{pageCount:p,previousPageCount:c});l&&n.handleEvent("page",{page:a,
previousPage:e});b(null)})}catch(m){return Promise.reject(m)}};b.b.g("FilmStripPagingModel.prototype.setPage",{setPage:b.Me.prototype.setPage});b.Me.prototype.getStartItemIndex=function(){return this.Hd*this.cb};b.b.g("FilmStripPagingModel.prototype.getStartItemIndex",{getStartItemIndex:b.Me.prototype.getStartItemIndex});b.Me.prototype.getEndItemIndex=function(){return Math.min(this.getStartItemIndex()+this.cb,this.rf)-1};b.b.g("FilmStripPagingModel.prototype.getEndItemIndex",{getEndItemIndex:b.Me.prototype.getEndItemIndex});
b.Me.prototype.getPageCount=function(){return Math.ceil(this.rf/this.cb)};b.b.g("FilmStripPagingModel.prototype.getPageCount",{getPageCount:b.Me.prototype.getPageCount});b.Me.prototype.totalSize=function(){return this.rf};b.b.g("FilmStripPagingModel.prototype.totalSize",{totalSize:b.Me.prototype.totalSize});b.Me.prototype.totalSizeConfidence=function(){return"actual"};b.b.g("FilmStripPagingModel.prototype.totalSizeConfidence",{totalSizeConfidence:b.Me.prototype.totalSizeConfidence});(function(){function a(a){var b=
f("\x3cdiv\x3e\x3c/div\x3e");b.text(a);return b[0].innerHTML}function d(a){a.css("-webkit-transform",m).css("-ms-transform",m).css("transform",m)}function c(a,b){a.css("-webkit-transform",b).css("-ms-transform",b).css("transform",b)}b.Ja("oj.ojFilmStrip",f.oj.baseComponent,{defaultElement:"\x3cdiv\x3e",widgetEventPrefix:"oj",options:{maxItemsPerPage:0,orientation:"horizontal",currentItem:0,arrowPlacement:"adjacent",arrowVisibility:"auto"},_ComponentCreate:function(){this._super();var a=this.element;
a.addClass("oj-filmstrip oj-component").attr("tabindex",0).attr("role","region");a.uniqueId();a=this.options;a.disabled&&b.r.warn(da);if(a.orientation!==x&&a.orientation!==fa)throw Error(s+a.orientation);if(a.arrowPlacement!==e&&a.arrowPlacement!==Y)throw Error(r+a.arrowPlacement);if(a.arrowVisibility!==ba&&a.arrowVisibility!==w&&a.arrowVisibility!==y&&a.arrowVisibility!==h)throw Error(u+a.arrowVisibility);this.zD=this.eventNamespace+"Touch";this.ZJ=this.eventNamespace+"Mouse";this.Sba=this.eventNamespace+
"Key";this.IV=this.eventNamespace+"NavArrowHoverable";this.Ma(!0)},refresh:function(){this._super();this.Ma(!1)},getItemsPerPage:function(){return this.zt},getPagingModel:function(){return this.nf},On:function(){this._super();this.Wd&&this.Ma(this.Wd[0])},Vp:function(){this._super();this.Wd&&this.Ma(this.Wd[0])},Ma:function(a){if(this.Qz()){this.Wd=null;this.Og="rtl"===this.Ic();this.iq=b.A.Zd();var c=this.element,d=this;a?(this.zt=0,this.nQ=function(a){d.mQ(a)},this.nf=new b.Me,this.nq=0,this.WA=
-1,this.Fm=function(){d.rt()},this.zi=function(){d.kg()},this.iq&&(this.t4=function(a){d.xQ(a)},this.s4=function(a){d.wQ(a)},this.vQ=function(a){d.uQ(a)},this.Hia()),this.h4=function(a){d.Apa(a)},this.i4=function(a){d.Bpa(a)},this.k4=function(a){d.Dpa(a)},this.Cia(),this.e4=function(a){d.nt(a)},this.Aia()):this.m1();for(var e=c.children(),f=0;f<e.length;f++)b.Components.di(e[f]);a&&(a=this.nf,a.ZBa(e.length),a.on("page",this.nQ));this.$wa();this.t_();for(f=0;f<e.length;f++)b.Components.nh(e[f]);b.A.uj(c[0],
this.zi)}else c=!1,this.Wd&&(c=this.Wd[0]),this.Wd=[a||c]},_destroy:function(){this.iq&&(this.hua(),this.vQ=this.s4=this.t4=null);this.Yta();this.k4=this.i4=this.h4=null;this.Wta();this.e4=null;this.m1();this.nf.off("page",this.nQ);this.Fm=this.zi=this.nf=this.nQ=null;var a=this.element;a.removeClass("oj-filmstrip oj-component "+H).removeAttr("tabindex role");a.removeUniqueId();this._super()},m1:function(){b.A.Gk(this.element[0],this.zi);this.WA=-1;this.vB&&(clearTimeout(this.vB),this.vB=null);for(var a=
this.nG(),c=0;c<a.length;c++)b.Components.di(a[c]);this.i0();this.hP().unwrap();this.Dwa();for(c=0;c<a.length;c++)b.Components.nh(a[c])},_setOption:function(a,c,d){var f=this.options,g=!1,k=-1,l=this.nf,m=l.getPage();switch(a){case "disabled":b.r.warn(da);break;case "orientation":if(c!==x&&c!==fa)throw Error(s+c);g=f.orientation!=c;break;case "maxItemsPerPage":g=f.maxItemsPerPage!=c;break;case "arrowPlacement":if(c!==e&&c!==Y)throw Error(r+c);g=f.arrowPlacement!=c;break;case "arrowVisibility":if(c!==
ba&&c!==w&&c!==y&&c!==h)throw Error(u+c);g=f.arrowVisibility!=c;break;case B:if(f.currentItem!=c&&(k=this.DO(c),0>k||k>=l.getPageCount()))throw Error(q+c);}this._super(a,c,d);switch(a){case B:-1<k&&k!=m&&l.setPage(k)}g&&this.Ma(!1)},kg:function(){if(!this.G_)this.G_=!0,this.t_(!0),this.G_=!1;else if(!this.vB){var a=this;this.vB=setTimeout(function(){a.vB=null;a.kg()},0)}},nc:function(){return this.options.orientation!==fa},pA:function(){return this.nc()?this.Og?"right":"left":"top"},Zs:function(){return this.nc()?
"width":"height"},Qz:function(){var a=document.createElement("div"),b=a.style;b.position="absolute";b.width="10px";b.height="10px";b=this.element[0];b.appendChild(a);var c=!1;try{c=0<a.offsetWidth&&0<a.offsetHeight}catch(d){}b.removeChild(a);return c},$wa:function(){var a=this.element,b=this.nc();a.children().addClass(I).wrap("\x3cdiv class\x3d'"+A+" "+L+"'\x3e\x3c/div\x3e");var c=this.pA();this.sl=c=a.children().wrapAll("\x3cdiv class\x3d'"+A+" "+J+"' style\x3d'"+c+": 0px;'\x3e\x3c/div\x3e").parent();
var d=this.options;d.arrowVisibility!==w&&d.arrowPlacement===e&&(this.LN=c.wrap("\x3cdiv class\x3d'"+A+" oj-filmstrip-content-container'\x3e\x3c/div\x3e").parent());a.addClass(A);b||a.addClass(R);d.arrowVisibility!==w&&(this.Lm=this.ela(),this.rl=this.Rka(),this.nR()&&this.Gva())},Dwa:function(){var a=this.element,b=this.nG();this.ewa();this.Lm&&(this.Es(this.Lm),this.Lm=null);this.rl&&(this.Es(this.rl),this.rl=null);var c=a.children(T+F);c&&c.remove();b.removeClass(I).unwrap().unwrap();this.sl=null;
this.LN&&(b.unwrap(),this.LN=null);a.removeClass(A+" "+R)},Gva:function(){this.element.on("mouseenter"+this.IV,function(a){f(a.currentTarget).hasClass("oj-disabled")||f(a.currentTarget).addClass(H)}).on("mouseleave"+this.IV,function(a){f(a.currentTarget).removeClass(H)})},ewa:function(){this.element.off(this.IV)},nR:function(){var a=this.options,b=a.arrowVisibility;return b===y||b===h&&a.arrowPlacement===Y},aqa:function(){return 0<this.nf.getPage()},$pa:function(){var a=this.nf;return a.getPage()<
a.getPageCount()-1},Ssa:function(){if(this.aqa()){var a=this.nf;a.setPage(a.getPage()-1)}},qsa:function(){if(this.$pa()){var a=this.nf;a.setPage(a.getPage()+1)}},u1:function(a,b){this.options.arrowPlacement===e?b.css("visibility",a?"":w):b.parent().css("display",a?"":C)},Swa:function(){if(this.options.arrowVisibility!==w){var a=this.nf,b=a.getPage(),a=a.getPageCount();this.u1(0!==b,this.Lm);this.u1(b!==a-1,this.rl)}},ela:function(){var b=this.element,c=this.nc()?V:ha,d=this.K0(c);this.options.arrowPlacement===
Y?b.append(d):b.prepend(d);var b=a(this.v("labelAccArrowPreviousPage")),e=a(this.v("tipArrowPreviousPage")),c=this.J0(d,c,b,e),f=this;c.on("click",function(){f.Ssa()});return c},Rka:function(){var b=this.element,c=this.nc()?G:M,d=this.K0(c);b.append(d);var b=a(this.v("labelAccArrowNextPage")),e=a(this.v("tipArrowNextPage")),c=this.J0(d,c,b,e),f=this;c.on("click",function(){f.qsa()});return c},K0:function(a){var b=f(document.createElement("div"));b.addClass(F+" "+a);this.options.arrowPlacement===Y&&
(b.addClass("oj-filmstrip-arrow-container-overlay"),this.nR()&&b.addClass(z));return b},J0:function(a,b,c,d){var f="\x3cdiv class\x3d'"+E+" oj-default oj-enabled "+b+"' role\x3d'button' tabindex\x3d'-1'";a.append(f+("\x3e\x3cspan class\x3d'oj-filmstrip-arrow-icon "+b+" oj-component-icon'\x3e\x3c/span\x3e\x3c/div\x3e"));b=this.element.attr("id");a=a.children(T+E).eq(0);a.uniqueId();f=a.attr("id");c&&a.attr("aria-label",c);d&&a.attr("title",d);a.attr("aria-labelledby",f+" "+b);this._hoverable(a);this.Ez(a);
this.options.arrowPlacement===e&&this.nR()&&a.addClass(z);return a},hP:function(){return this.sl.find(T+L)},nG:function(){return this.sl.find(T+I)},xq:function(){return this.sl.children(T+D)},i0:function(){var a=this.sl;this.xq().css(v,m).css(ca,m);this.hP().css(v,m).css(ca,m);a.css(this.Zs(),m)},t_:function(a){this.i0();var c=this.options,d=this.nc(),h=c.maxItemsPerPage,l=1>h,n=this.element,p=this.hP();if(0>this.WA){var q=this.R2(c.currentItem),q=f(p[q]),r=q.children(T+I);r.css(k,m);b.Components.xp(r[0]);
this.WA=d?q.width():q.height()}q=d?n.width():n.height();c.arrowVisibility!==w&&c.arrowPlacement===e&&(n=n.children(T+F).eq(0),d=d?n.width():n.height(),q-=2*d);this.nq=q;l||(d=Math.max(Math.floor(q/this.WA),1),d<h&&(h=d));h=l?Math.max(Math.floor(q/this.WA),1):h;l=q/h;p.css(v,l+aa).css(ca,l+aa);l=Math.ceil(p.length/h);r=this.xq();d=!1;n=this.nf;if(n.getPageCount()!=l||this.zt!=h||!r||1>r.length){d=!0;if(a)for(var s=0;s<p.length;s++)b.Components.di(p[s]);r&&0<r.length&&p.unwrap();for(s=0;s<p.length;s+=
h)p.slice(s,s+h).wrapAll("\x3cdiv class\x3d'"+A+" "+D+"' style\x3d'"+k+": "+C+";' "+g+"\x3d'true'\x3e\x3c/div\x3e");if(a)for(s=0;s<p.length;s++)b.Components.nh(p[s])}r=this.xq();r.css(v,q+aa).css(ca,q+aa);a=this.LN;this.sl.css(this.Zs(),q);a&&a.css(this.Zs(),q);a=0;if(c.currentItem||0===c.currentItem)a=this.DO(c.currentItem,h);n.getPageCount()!=l||this.zt!=h||n.getPage()!=a?n.setPage(a,{pageSize:h}):d&&(c=n.getPage(),this.mQ({previousPage:c,page:c}))},mQ:function(a){var b=a.page,c=a.previousPage;
a=this.sl;var d=this.xq(),e=this.nf.cb,g=0>c||c==b||this.zt!=e;this.zt=e;e=null;g||(e=f(d[c]));var h=this.pA(),k=f(d[b]),l=k.is(t);l&&this.eT(k);var m=this.Wv;-1<c&&!g&&(m=!0,a.css(this.Zs(),2*this.nq),b<c&&l&&a.css(h,-this.nq+aa),b>c?(e.addClass(Q),k.addClass(K)):(e.addClass(U),k.addClass(O)));if(m){var n=this,p=this.Wv;p&&0>c&&d.filter(S).addClass(N);setTimeout(function(){n.V1(b,c,g,p)},25)}else this.V1(b,c,g)},V1:function(a,b,e,g){var h=this.sl;e||(this.H_=!0,h.on("transitionend"+this.eventNamespace+
" webkitTransitionEnd"+this.eventNamespace,this.Fm));e?this.rt():(e=this.xq(),g&&d(e),-1<b?(g=a>b,b=f(e[b]),a=f(e[a]),b.addClass(N),a.addClass(N),g?(b.removeClass(Q),a.removeClass(K),b.addClass(W),a.addClass(P)):(b.removeClass(U),a.removeClass(O),b.addClass(X),a.addClass(Z))):g&&(a=e.filter(S),c(a,"translate3d(0, 0, 0)")))},rt:function(){this.H_=!1;var a=this.sl,c=this.pA();a.off(this.eventNamespace).css(this.Zs(),this.nq).css(c,"0px");c=null;if(b.te.MI(a[0])||this.rl&&b.te.MI(this.rl[0])||this.Lm&&
b.te.MI(this.Lm[0]))c=document.activeElement;for(var a=this.nf.getPage(),e=this.xq(),g=0;g<e.length;g++)g!=a&&this.z4(f(e[g]));e.removeClass(N+" "+W+" "+P+" "+X+" "+Z);d(e);this.Swa();c&&f(c).is(t)&&(c=this.element,(e=b.te.naa(e[a]))?b.te.oC(e):b.te.oC(c[0]));this.DO(this.options.currentItem)!=a&&(a=this.F2(a),this.option(B,a,{_context:{zd:!0}}))},R2:function(a){var c=-1,d=this.nG();if("number"===typeof a)0<=a&&a<d.length&&(c=a);else if("string"===typeof a&&b.A.yJ(a))for(var e=0;e<d.length;e++){var f=
d[e].id;if(f&&0<f.length&&f===a){c=e;break}}return c},DO:function(a,b){var c=this.R2(a),d=-1;-1<c&&(void 0===b&&(b=this.zt),d=Math.floor(c/b));return d},F2:function(a,b,c){var d=this.nf;void 0===b&&(b=d.getPageCount());return 0<=a&&a<b&&(b=this.nG(),void 0===c&&(c=this.zt),a*=c,a<b.length)?(c=b[a].id)&&0<c.length?c:a:-1},z4:function(a){b.Components.Rr(a[0]);a.css(k,C).attr(g,"true");a.find(T+I).css(k,C)},eT:function(a){a.css(k,m).removeAttr(g);a.find(T+I).css(k,m);b.Components.xp(a[0])},Aia:function(){this.element.on("keydown"+
this.Sba,this.e4)},Wta:function(){this.element.off(this.Sba)},Cia:function(){this.element.on("mousedown"+this.ZJ,this.h4).on("mousemove"+this.ZJ,this.i4).on("mouseup"+this.ZJ,this.k4)},Yta:function(){this.element.off(this.ZJ)},Hia:function(){this.element.on("touchstart"+this.zD,this.t4).on("touchmove"+this.zD,this.s4).on("touchend"+this.zD,this.vQ).on("touchcancel"+this.zD,this.vQ)},hua:function(){this.element.off(this.zD)},nt:function(a){var b=this.nf,c=b.getPage(),d=-1;switch(a.keyCode){case f.ui.keyCode.RIGHT:d=
this.Og?c-1:c+1;break;case f.ui.keyCode.LEFT:d=this.Og?c+1:c-1;break;case f.ui.keyCode.DOWN:d=c+1;break;case f.ui.keyCode.UP:d=c-1;break;case f.ui.keyCode.HOME:d=0;break;case f.ui.keyCode.END:d=b.getPageCount()-1;break;default:return}-1<d&&d<b.getPageCount()&&b.setPage(d);a.preventDefault()},Apa:function(a){this.F1(a.originalEvent)},Bpa:function(a){this.E1(a,a.originalEvent)},Dpa:function(){this.D1()},xQ:function(a){a=a.originalEvent.touches;1===a.length&&this.F1(a[0])},wQ:function(a){this.E1(a,a.originalEvent.touches[0]);
(this.Xj||this.Lt)&&a.preventDefault()},uQ:function(){this.D1()},F1:function(a){if(1<this.nf.getPageCount()&&!this.H_){this.Xj=!0;this.Wv=!1;var b=this.nc();this.iI=b?a.pageX:a.pageY;this.q9=b?a.pageY:a.pageX}},rqa:function(a){var b=this.nc();this.iI=b?a.pageX:a.pageY;this.q9=b?a.pageY:a.pageX;a=this.pA();var b=this.sl,c=this.nf,d=this.xq(),e=1;0<c.getPage()&&(this.eT(f(d[c.getPage()-1])),b.css(a,-this.nq+aa),e++);c.getPage()<c.getPageCount()-1&&(this.eT(f(d[c.getPage()+1])),e++);1<e&&b.css(this.Zs(),
e*this.nq);this.PS=parseInt(b.css(a),10)},E1:function(a,b){if(this.Xj){var d=this.nc(),e=(d?b.pageX:b.pageY)-this.iI;Math.abs((d?b.pageY:b.pageX)-this.q9)>Math.abs(e)&&(this.Lt=this.Xj=!1);if(this.Wv){var g=d&&this.Og?0<e:0>e,h=this.nf,k=h.getPage();if(g&&k<h.getPageCount()-1||!g&&0<k){var m=this.element[0],q=Math.min(p*(d?m.offsetWidth:m.offsetHeight),n),r=this.pA(),s=this.sl,m=this.xq();Math.abs(e)>=q?(d=g?k+1:k-1,this.F2(d),k=g?k-1:k+1,-1<k&&k<h.getPageCount()&&this.z4(f(m[k])),g&&-1<k&&(m=parseInt(s.css(r),
10),s.css(r,m+this.nq+aa)),s.css(this.Zs(),2*this.nq),this.Xj=!1,h.setPage(d)):(h=d&&this.Og?-e:e,h=d?"translate3d("+h+"px, 0, 0)":"translate3d(0, "+h+"px, 0)",c(m.filter(S),h));this.Lt=!0}this.Lt&&(a.preventDefault(),a.stopPropagation())}else Math.abs(e)>l&&(this.rqa(b),this.Wv=!0)}},D1:function(){if(this.Xj&&this.Wv){var a=this.nf.getPage();this.mQ({previousPage:a,page:a})}this.Lt=this.Wv=this.Xj=!1},getNodeBySubId:function(a){if(null==a)return this.element?this.element[0]:null;a=a.subId;return"oj-filmstrip-start-arrow"===
a?this.widget().find(T+E+T+V)[0]:"oj-filmstrip-end-arrow"===a?this.widget().find(T+E+T+G)[0]:"oj-filmstrip-top-arrow"===a?this.widget().find(T+E+T+ha)[0]:"oj-filmstrip-bottom-arrow"===a?this.widget().find(T+E+T+M)[0]:null},getSubIdByNode:function(a){for(var b=this.getNodeBySubId({subId:"oj-filmstrip-start-arrow"}),c=this.getNodeBySubId({subId:"oj-filmstrip-end-arrow"}),d=this.getNodeBySubId({subId:"oj-filmstrip-top-arrow"}),e=this.getNodeBySubId({subId:"oj-filmstrip-bottom-arrow"}),f=this.element[0];a&&
a!=f;){if(a===b)return{subId:"oj-filmstrip-start-arrow"};if(a===c)return{subId:"oj-filmstrip-end-arrow"};if(a===d)return{subId:"oj-filmstrip-top-arrow"};if(a===e)return{subId:"oj-filmstrip-bottom-arrow"};a=a.parentElement}return null}});var e="adjacent",g="aria-hidden",h="auto",k="display",l=3,p=.33,n=100,m="",q="JET FilmStrip: Value of 'currentItem' option not found: ",s="JET FilmStrip: Unsupported value set as 'orientation' option: ",r="Unsupported value set as 'arrowPlacement' option: ",u="Unsupported value set as 'arrowVisibility' option: ",
v="flex-basis",w="hidden",t=":hidden",x="horizontal",y="hover",B="currentItem",C="none",M="oj-bottom",G="oj-end",E="oj-filmstrip-arrow",F="oj-filmstrip-arrow-container",z="oj-filmstrip-arrow-transition",A="oj-filmstrip-container",H="oj-filmstrip-hover",I="oj-filmstrip-item",L="oj-filmstrip-item-container",D="oj-filmstrip-page",J="oj-filmstrip-pages-container",N="oj-filmstrip-transition",K="oj-filmstrip-transition-next-newpage-from",Q="oj-filmstrip-transition-next-oldpage-from",O="oj-filmstrip-transition-prev-newpage-from",
U="oj-filmstrip-transition-prev-oldpage-from",P="oj-filmstrip-transition-next-newpage-to",W="oj-filmstrip-transition-next-oldpage-to",Z="oj-filmstrip-transition-prev-newpage-to",X="oj-filmstrip-transition-prev-oldpage-to",R="oj-filmstrip-vertical",V="oj-start",ha="oj-top",Y="overlay",T=".",aa="px",fa="vertical",ba="visible",S=":visible",ca="-webkit-flex-basis",da="JET FilmStrip: 'disabled' option not supported"})()});