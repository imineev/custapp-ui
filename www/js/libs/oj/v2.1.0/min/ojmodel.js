/**
 * Copyright (c) 2014, 2016, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(["ojs/ojcore","jquery","promise"],function(b,f){b.ba=window.oj.Events={on:function(a,b,c){return this.Kn(a,b,c,!1,!1)},off:function(a,b,c){return this.rR(a,b,c,!1)},trigger:function(a){var d=Array.prototype.slice.call(arguments);d.unshift(!1);return b.ba.mc.apply(this,d)},once:function(a,b,c){return this.l6(a,b,c,!1,null)},listenTo:function(a,d,c){var e,g,h,k,f={};d.constructor===String?f[d]=c:f=d;for(k in f)if(f.hasOwnProperty(k))for(d=b.ba.ct(k),c=0;c<d.length;c+=1)e=d[c].event,g=d[c].Z,
h={event:e,Z:g,object:a,ec:f[k]},this.zN(this._listeningTo,h,b.ba.J5),e=g?e+":"+g:e,void 0===this._listeningTo&&(this._listeningTo=[]),this._listeningTo.push(h),a.Kn(e,f[k],null,!0,!1);return this},listenToOnce:function(a,d,c){var e,g,h,k,f={};d.constructor===String?f[d]=c:f=d;for(k in f)if(f.hasOwnProperty(k))for(d=b.ba.ct(k),c=0;c<d.length;c+=1)e=d[c].event,g=d[c].Z,h={event:e,Z:g,object:a,ec:f[k]},this.zN(this._listeningTo,h,b.ba.J5),e=g?e+":"+g:e,void 0===this._listeningTo&&(this._listeningTo=
[]),this._listeningTo.push(h),a.l6(e,f[k],null,!0,this);return this},stopListening:function(a,d,c){var e,g={},h,k,f,p,n,m,q,s,r;if(null==arguments||1>=arguments.length){m=this._listeningTo?this._listeningTo.length:0;for(s=0;s<m;s++)if(p=this._listeningTo[s],n=a?a===p.object:!0)n=p.object.rR,n.apply(p.object,[p.event,p.ec,p.context,!0]);this._listeningTo=[];return this}e=d;a&&a.constructor===String&&(e=a);e.constructor===String?g[e]=c:g=e;for(r in g)if(g.hasOwnProperty(r))for(e=b.ba.ct(r),h=0;h<e.length;h+=
1)for(k=e[h].event,f=e[h].Z,m=this._listeningTo?this._listeningTo.length:0,s=m-1;0<=s;s-=1)p=this._listeningTo[s],n=a?a===p.object:!0,m=k?k===p.event:!0,q=c?g[r]===p.ec:!0,p=f?f===p.Z:!0,n&&m&&q&&p&&(n=this._listeningTo[s].object.rR,n.apply(this._listeningTo[s].object,[this._listeningTo[s].event,this._listeningTo[s].ec,this._listeningTo[s].context,!0]),this._listeningTo.splice(s,1));return this}};b.ba.bind=b.ba.on;b.ba.unbind=b.ba.off;b.ba.N={ADD:"add",ALLADDED:"alladded",REMOVE:"remove",RESET:"reset",
REFRESH:"refresh",SORT:"sort",CHANGE:"change",DESTROY:"destroy",ALLREMOVED:"allremoved",REQUEST:"request",SYNC:"sync",ERROR:"error",INVALID:"invalid",READY:"ready",ALL:"all"};o_("Events.EventType",b.ba.N,b);b.ba.gL=function(a,b){var c,e=b||this;for(c in e)"function"===typeof e[c]&&(a[c]=e[c]);a.Yd={};a._listeningTo=[]};b.ba.l6=function(a,b,c,e,g){var h,k,f,p;f=this.aP(a,b);for(p in f)if(f.hasOwnProperty(p))for(a=this.ct(p),b=0;b<a.length;b+=1)h=a[b].event,k=a[b].Z,void 0===this.Yd&&(this.Yd=[]),void 0===
this.Yd[h]&&(this.Yd[h]=[]),this.Yd[h].push({ec:f[p],context:c,Z:k,kp:!0,fired:!1,wr:e,mD:g});return this};b.ba.A8=function(a){return a.kp?a.fired?!1:a.fired=!0:!0};b.ba.v2=function(a,b){return b.context||b.mD||a};b.ba.mc=function(a,d){var c=this.ct(d),e,g,h,k,f,p;k=[];for(e=0;e<c.length;e+=1)g=c[e].event,h=c[e].Z,k.push({event:g,Z:h});for(e=0;e<k.length;e+=1){f=this.kG(this.Yd,b.ba.N.ALL);c=b.ba.kG(this.Yd,k[e].event,!1);for(g=0;g<(c?c.length:0);g+=1)c[g].Z===k[e].Z&&c[g].ec&&(h=Array.prototype.slice.call(arguments),
c&&c[g]&&c[g].kp&&(this.i7(b.ba.kG(this.Yd,k[e].event,!0),c[g]),c[g].mD&&c[g].mD.stopListening(this,d,c[g].ec)),c&&c[g]&&this.A8(c[g])&&(p=c[g].ec,a&&!c[g].Cba||p.apply(b.ba.v2(this,c[g]),h.slice(2))));for(g=0;g<(f?f.length:0);g+=1)h=Array.prototype.slice.call(arguments),0<h.length&&(h[1]=k[e].Z?k[e].event+":"+k[e].Z:k[e].event),f&&f[g]&&f[g].ec&&this.A8(f[g])&&(p=f[g].ec,a&&!f[g].Cba||p.apply(b.ba.v2(this,f[g]),h.slice(1))),f&&f[g]&&f[g].kp&&(this.i7(this.kG(this.Yd,b.ba.N.ALL,!0),f[g]),f[g].mD&&
f[g].mD.stopListening(this,b.ba.N.ALL,f[g].ec))}return this};b.ba.Kn=function(a,d,c,e,g){var h,k,f,p;a=this.aP(a,d);for(h in a)if(a.hasOwnProperty(h))for(d=this.ct(h),k=0;k<d.length;k+=1)f=d[k].event,p=d[k].Z,void 0===this.Yd&&(this.Yd=[]),void 0===this.Yd[f]&&(this.Yd[f]=[]),p={ec:a[h],context:c,Z:p,wr:e,Cba:g},-1===this.zN(this.Yd[f],p,b.ba.Wpa)&&this.Yd[f].push(p);return this};b.ba.rR=function(a,b,c,e){var g,h;if(null==arguments||0==arguments.length)return this.Yd={},this;if(null==a)return this.h7(a,
b,c,e),this;g=this.aP(a,b);for(h in g)g.hasOwnProperty(h)&&this.h7(h,g[h],c,e);return this};b.ba.aP=function(a,b){var c={};a.constructor===String?c[a]=b:c=a;return c};b.ba.h7=function(a,d,c,e){var g=[],h,k,f,p,n,m,q,s;if(a)g=b.ba.ct(a);else if(void 0!==this.Yd)for(k in this.Yd)this.Yd.hasOwnProperty(k)&&g.push({event:k});for(a=0;a<g.length;a+=1)if(k=g[a].event,f=g[a].Z,void 0!==this.Yd&&this.Yd[k]instanceof Array){p=this.Yd[k];for(h=p.length-1;0<=h;h-=1)n=void 0===d||null===d||p[h].ec==d,m=void 0===
c||null===c||p[h].context==c,q=void 0===f||null===f||p[h].Z==f,s=void 0===e||null===e||p[h].wr==e,n&&m&&q&&s&&p.splice(h,1);0===p.length&&delete this.Yd[k]}};b.ba.i7=function(a,b){var c,e,g,h,k,f;if(a)for(c=a.length-1;0<=c;c-=1)e=void 0===b.ec||null===b.ec||a[c].ec==b.ec,g=void 0===b.context||null===b.context||a[c].context==b.context,h=void 0===b.Z||null===b.Z||a[c].Z==b.Z,k=void 0===b.wr||null===b.wr||a[c].wr==b.wr,f=void 0===b.kp||null===b.kp||a[c].kp==b.kp,e&&g&&h&&k&&f&&a.splice(c,1)};b.ba.ct=
function(a){a=a?a.split(" "):[];var b=[],c,e,g;for(c=0;c<a.length;c+=1)e=a[c].split(":"),g=e[0],e=1<e.length?e[1]:null,b.push({event:g,Z:e});return b};b.ba.Wpa=function(a,b){return a.ec===b.ec&&a.Z===b.Z&&a.context===b.context&&a.wr===b.wr&&a.kp===b.kp};b.ba.J5=function(a,b){return a.event===b.event&&a.Z===b.Z&&a.context===b.context&&a.object===b.object};b.ba.zN=function(a,b,c){var e;if(void 0===a)return-1;for(e=0;e<a.length;e+=1)if(c(a[e],b))return e;return-1};b.ba.kG=function(a,b,c){if(a&&a[b]instanceof
Array){if(c)return a[b];c=[];var e;for(e=0;e<a[b].length;e++)c.push(a[b][e]);return c}return null};b.t=function(a,d){b.t._init(this,a,d,null)};o_("Model",b.t,b);b.b.la(b.t,b.b,"oj.Model");b.t.prototype.Init=function(){b.t.p.Init.call(this)};b.t.prototype.attributes={};b.b.g("Model.prototype.attributes",{attributes:b.t.prototype.attributes});b.t.prototype.td={};b.b.g("Model.prototype.defaults",{td:b.t.prototype.td});b.t.prototype.id=null;b.b.g("Model.prototype.id",{id:b.t.prototype.id});b.t.prototype.Bba=
"id";b.b.g("Model.prototype.idAttribute",{Bba:b.t.prototype.Bba});b.t.prototype.jea=null;b.b.g("Model.prototype.urlRoot",{jea:b.t.prototype.jea});b.t.prototype.Cl=null;b.b.g("Model.prototype.customURL",{Cl:b.t.prototype.Cl});b.t.GQ=0;b.t._init=function(a,d,c,e){var g=null,h;if(!b.t.XA){a.Init();b.ba.gL(a);a.Xv();a.SV={};a.$J=!1;a.index=-1;c=c||{};a.attributes={};a.defaults&&!c.tAa&&(a.attributes=b.t.lF(f.isFunction(a.defaults)?a.defaults():a.defaults,null));for(g in e)e.hasOwnProperty(g)&&(a[g]=e[g]);
if(d)if(e=c.parse,f.isFunction(e)&&(a.parse=e),h=b.t.lF(d,a.attributes),h=e?a.parse(h):h,null==h||void 0===h)a.attributes={};else for(g in h)h.hasOwnProperty(g)&&a.rS(g,h[g],!1,!1,c);a.RD();a.Yy(c.collection);c.customURL&&(a.customURL=c.customURL);c.url&&(a.url=c.url);c.urlRoot&&(a.urlRoot=c.urlRoot);a.initialize&&a.initialize(d,c);a.fm()}};b.t.extend=function(a,d){b.t.XA=!0;var c,e;c=new b.t;b.t.XA=!1;f.extend(c,this.prototype);a=a||{};for(e in a)a.hasOwnProperty(e)&&(c[e]=a[e]);var g;g=a&&a.constructor&&
a.hasOwnProperty("constructor")?a.constructor:function(d,c){b.t._init(this,d,c,a)};f.extend(g,this);g.prototype=c;g.extend=b.t.extend;g.prototype.constructor=g;b.ba.gL(g,this);if(d)for(e in d)d.hasOwnProperty(e)&&(g[e]=d[e]);return g};o_("Model.extend",b.t.extend,b);b.t.prototype.mc=function(){};b.t.prototype.RD=function(){this.bs()||(this.cid="id"+b.t.GQ,b.t.GQ+=1)};b.t.prototype.bs=function(){return this.cid};b.t.prototype.Zy=function(a){this.index=a};b.t.prototype.Mea=function(){return this.index};
b.t.prototype.qL=function(a){this.eBa=a};b.t.prototype.SD=function(a){var b=this.TV;this.TV=a;return b};b.t.prototype.afa=function(a,d,c){var e,g=!1,h=b.Ra.oe(d),k,f=!1;for(e in a.attributes)a.attributes.hasOwnProperty(e)&&(k=this.attributes[e]!=a.attributes[e],h?e===d&&k&&(g=!0):k&&(g=!0),k&&(f=!0,this.attributes[e]=a.attributes[e],this.OM(e,a.attributes[e]),this.OF(e,this.attributes[e],null,c)));this.fm();f&&this.PF(null,c);return g};b.t.KG=function(a){var b;if(a&&a instanceof Object)for(b in a)if(a.hasOwnProperty(b))return!0;
return!1};b.t.prototype.Yy=function(a){null==a?delete this.collection:(this.collection=a,this.fm())};b.t.prototype.Ly=function(){return this.collection};b.t.prototype.OF=function(a,d,c,e){null!=a&&this.mc(e,b.ba.N.CHANGE+":"+a,this,d,c)};b.t.prototype.PF=function(a,d){this.mc(d,b.ba.N.CHANGE,this,a,null)};b.t.prototype.fm=function(){var a=null;this.collection&&this.collection.modelId&&(a=this.collection.modelId,a=f.isFunction(a)?a.call(this.collection,this.attributes):a);a||(a=this.gP(),a=null!=this.attributes?
this.attributes[a]:null);this.id=a};b.t.prototype.tva=function(a,d,c){var e=b.b.Az(this.attributes[a],d);return c||!e?(this.attributes[a]=d,this.fm(),!e):!1};b.t.prototype.Xv=function(){this.changed={}};b.t.prototype.OM=function(a,b){this.changed[a]=b};b.t.prototype.rS=function(a,d,c,e,g){if(null==a)return!0;var h={},k,f=this.$J;if(e)for(k in a)a.hasOwnProperty(k)&&(h[k]=a[k]);else h[a]=d;a=g||{};if(!this.Tz(h,{validate:a.validate},!1))return!1;f||(this.Xv(),this.gr=[]);this.$J||(this.SV=b.t.lF(this.attributes,
null));this.$J=!0;for(k in h)h.hasOwnProperty(k)&&(this.tva(k,h[k],c)?(this.OM(k,h[k]),this.gr.push(k)):delete h[k]);c=a.silent;for(k in h)h.hasOwnProperty(k)&&(!c&&(0<this.gr.length||f&&-1===this.gr.indexOf(k))&&(this.Kca=!0,this.mBa=a),this.OF(k,h[k],a,c));if(f)return!0;if(!c&&!f)for(;this.Kca;)this.Kca=!1,this.PF(this.mBa,c);this.$J=!1;return!0};b.t.prototype.clear=function(a){var d,c={silent:!0},e;a=a||{};e=a.silent;c.validate=a.validate;this.Xv();for(d in this.attributes)if(this.attributes.hasOwnProperty(d)){if(!this.nI(d,
c,!0))return!1;this.mc(e,b.ba.N.CHANGE+":"+d,this,void 0,null)}this.attributes={};this.fm();this.OF(null,null,null,e);this.PF(null,e);return this};b.b.g("Model.prototype.clear",{clear:b.t.prototype.clear});b.t.lF=function(a,d){d=d||{};for(var c in a)d.hasOwnProperty(c)&&a.hasOwnProperty(c)&&void 0===a[c]&&delete a[c];b.Zc.sg(d,a,void 0,!0,1E4);return d};b.t.prototype.clone=function(){var a=new this.constructor,d;for(d in this)this.hasOwnProperty(d)&&this[d]!==this.attributes&&(a[d]=this[d]);a.attributes=
b.t.lF(this.attributes,null);delete a.cid;a.RD();a.fm();return a};b.b.g("Model.prototype.clone",{clone:b.t.prototype.clone});b.t.prototype.hs=function(a,b){var c=this.wh();if(void 0!==c&&c==a)return!0;c=this.cid;return void 0!==c&&c==b?!0:!1};b.t.prototype.set=function(a,d,c){var e=c||{},g,h=!0;if(arguments&&0<arguments.length)if(b.Ra.oe(a))e.unset?this.nI(a,null,!1):this.rS(a,d,!1,!1,e)||(h=!1);else if(e=d||{},e.unset)for(g in a)a.hasOwnProperty(g)&&this.nI(g,null,!1);else this.rS(a,null,!0,!0,e)||
(h=!1);return h?this:!1};b.b.g("Model.prototype.set",{set:b.t.prototype.set});b.t.prototype.hea=function(a,b){return this.nI(a,b,!1)};b.b.g("Model.prototype.unset",{hea:b.t.prototype.hea});b.t.prototype.nI=function(a,b,c){b=b||{};var e=b.silent,g={};if(this.has(a)){if(!this.Tz(g,b,!1))return!1;c||this.Xv();delete this.attributes[a];this.OM(a,void 0);this.OF(a,null,null,e);this.PF(null,e)}this.fm();return!0};b.t.prototype.get=function(a){return this.attributes[a]};b.b.g("Model.prototype.get",{get:b.t.prototype.get});
b.t.prototype.has=function(a){return b.j.Zn(this.attributes[a])};b.b.g("Model.prototype.has",{has:b.t.prototype.has});b.t.prototype.fetch=function(a){a=a||{};var d=a.success,c=a.error,e=this,g;g=b.t.Qs(a);g.error=function(d,g,f){b.t.YB(e,!1,a,g,f,d);c&&c.apply(e,arguments)};g.success=function(c){g.xhr&&(a.xhr=g.xhr);b.t.TF(e,c,g);f.isFunction(e.parse)&&e.set(e.parse(c),g);d&&d.call(e,this,c,a)};return b.t.OA("read",this,g)};b.b.g("Model.prototype.fetch",{fetch:b.t.prototype.fetch});b.t.prototype.parse=
function(a){return a};b.t.prototype.url=function(){var a=this.L3(),d=this.wh();if(a)return d?a+"/"+encodeURIComponent(d):a;if(a=this.collection)return a=b.t.Fp(a,"url"),d&&a?(d="/"==b.t.Ana(a)?"":"/",a+d+encodeURIComponent(this.wh())):a;throw new b.Np;};b.b.g("Model.prototype.url",{url:b.t.prototype.url});b.t.prototype.keys=function(){var a,b=[];for(a in this.attributes)this.attributes.hasOwnProperty(a)&&b.push(a);return b};b.b.g("Model.prototype.keys",{keys:b.t.prototype.keys});b.t.prototype.lea=
function(){var a,b=[];for(a in this.attributes)this.attributes.hasOwnProperty(a)&&b.push(this.get(a));return b};b.b.g("Model.prototype.values",{lea:b.t.prototype.lea});b.t.prototype.Ica=function(){var a,b=[],c;for(a in this.attributes)this.attributes.hasOwnProperty(a)&&(c=[],c.push(a),c.push(this.get(a)),b.push(c));return b};b.b.g("Model.prototype.pairs",{Ica:b.t.prototype.Ica});b.t.prototype.Gca=function(a){var b=[],c,e,g={};if(a instanceof Array)b=a;else for(c=0;c<arguments.length;c++)b.push(arguments[c]);
for(e in this.attributes)this.attributes.hasOwnProperty(e)&&-1==b.indexOf(e)&&(g[e]=this.get(e));return g};b.b.g("Model.prototype.omit",{Gca:b.t.prototype.Gca});b.t.prototype.Lca=function(a){var b=[],c,e={};if(a instanceof Array)b=a;else for(c=0;c<arguments.length;c++)b.push(arguments[c]);for(c=0;c<b.length;c++)this.attributes.hasOwnProperty(b[c])&&(e[b[c]]=this.get(b[c]));return e};b.b.g("Model.prototype.pick",{Lca:b.t.prototype.Lca});b.t.prototype.Iba=function(){var a,b={},c;for(a in this.attributes)this.attributes.hasOwnProperty(a)&&
(c=this.get(a),b[c]=a);return b};b.b.g("Model.prototype.invert",{Iba:b.t.prototype.Iba});b.t.Ana=function(a){return a.charAt(a.length-1)};b.t.prototype.Fua=function(){var a=this.L3();return a?a:this.Ly()?this.Ly().url:null};b.t.prototype.L3=function(){return b.t.Fp(this,"urlRoot")};b.t.prototype.parseSave=function(a){return a};b.t.prototype.isValid=function(){var a={};a.validate=this.validate;return this.Tz(this.attributes,a,!1)};b.b.g("Model.prototype.isValid",{isValid:b.t.prototype.isValid});b.t.pra=
function(a,b){a=a||{};return void 0!==a.validate&&null!==a.validate?a.validate:b};b.t.prototype.Tz=function(a,d,c){d=d||{};var e=this.validate;return e&&b.t.pra(d,c)&&(this.validationError=e.call(this,a,d))?(this.mc(!1,b.ba.N.INVALID,this,this.validationError,d),!1):!0};b.t.Usa=function(a){var d=!1,c={},e,g={};if(a&&0<a.length){1<a.length&&a[a.length-1]&&b.t.KG(a[a.length-1])&&(d=!0,c=a[a.length-1]||{});if(null==a[0])return{attributes:null,options:c};if(b.t.KG(a[0])||b.b.ih(a[0]))for(e in a[0])a[0].hasOwnProperty(e)&&
(g[e]=a[0][e]);else for(e=0;e<a.length;e+=2)if(void 0!==a[e]||e<a.length-1||!d&&e===a.length-1)g[a[e]]=a[e+1]}return{attributes:g,options:c}};b.t.Qs=function(a){var b={},c;a=a||{};for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b};b.t.YB=function(a,d,c,e,g,h){c=c||{};c.textStatus=e;c.errorThrown=g;a.mc(d,b.ba.N.ERROR,a,h,c)};b.t.prototype.save=function(a,d){var c,e,g,h,k,l;c=b.t.Usa(arguments);var p,n,m;m=void 0===a?void 0:c.attributes;d=d||{};p=b.t.Qs(c.options);if(!this.Tz(this.attributes,p,
!0))return!1;p.wait||this.set(m);c=void 0===p.forceNew?!1:p.forceNew;h=this;k=p.error;l=p.patch;p.error=function(a,c,g){b.t.YB(h,!1,d,c,g,a);k&&k.apply(h,arguments)};p.saveAttrs=p.wait?this.fja(m):this.attributes;n=this.attributes;this.attributes=p.saveAttrs;p.saveAttrs=this.toJSON();this.attributes=n;if(!c&&!this.wJ())return e=p.success,p.success=function(a){var c;p.xhr&&(d.xhr=p.xhr);if(a&&!b.b.ih(a)){c=f.isFunction(h.parse)?h.parse(a):a;h.attributes=f.extend(!0,h.attributes,c);if(p.wait)for(var g in m)c.hasOwnProperty(g)&&
(m[g]=c[g]);h.fm()}b.t.TF(h,a,p);p.wait&&h.set(m);e&&e.call(b.t.Qk(p,h),h,a,d);h.Xv()},p.attrs||(p.attrs=void 0===m?void 0:l?m:p.saveAttrs),b.t.OA(l?"patch":"update",this,p);g=b.t.D3(p);p.success=function(a){var c;p.xhr&&(d.xhr=p.xhr);if(a&&!b.b.ih(a)){c=f.isFunction(h.parse)?h.parse(a):a;if(!h.Tz(c,p,!0))return;h.attributes=f.extend(!0,h.attributes,c);if(p.wait)for(var e in m)c.hasOwnProperty(e)&&(m[e]=c[e]);h.fm()}b.t.TF(h,a,p);p.wait&&h.set(m);g&&g.call(b.t.Qk(p,h),h,a,d);h.Xv()};p.attrs||(p.attrs=
p.saveAttrs);p.parse=!0;l&&(p.saveAttrs=p.attrs);return b.t.OA("create",this,p)};b.b.g("Model.prototype.save",{save:b.t.prototype.save});b.t.prototype.fja=function(a){var b={},c;for(c in this.attributes)this.attributes.hasOwnProperty(c)&&(b[c]=this.attributes[c]);for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b};b.t.Fp=function(a,b){return a?f.isFunction(a[b])?a[b]():a[b]:f.isFunction(b)?b():b};b.t.gX=function(a){return a&&a.hasOwnProperty("value")&&a.hasOwnProperty("comparator")};b.t.prototype.Ypa=
function(a){for(var d in a)if(a.hasOwnProperty(d)){if(!this.attributes.hasOwnProperty(d))return!1;for(var c=Array.isArray(a[d])?a[d]:[a[d]],e=0;e<c.length;e++)if(b.t.gX(c[e])){var g=c[e].comparator,h=c[e].value;if(b.Ra.oe(g))throw Error("String comparator invalid for local where/findWhere");if(!g(this,d,h))return!1}else if(a[d]!==this.attributes[d])return!1}return!0};b.t.prototype.matches=function(a){a:{for(var b in a)if(this.get(b)!==a[b]){a=!1;break a}a=!0}return a};b.b.g("Model.prototype.matches",
{matches:b.t.prototype.matches});b.t.prototype.zea=function(a){a=a.constructor===Array?a:[a];var b;for(b=0;b<a.length;b++)if(this.Ypa(a[b]))return!0;return!1};b.t.D3=function(a){return null!=a&&a.success?a.success:null};b.t.Qk=function(a,b){return void 0!==a&&void 0!==a.context?a.context:b};b.t.prototype.wJ=function(){return void 0==this.wh()};b.b.g("Model.prototype.isNew",{wJ:b.t.prototype.wJ});b.t.prototype.gP=function(){return this.idAttribute||"id"};b.t.prototype.wh=function(){return this.id};
b.t.prototype.GT=function(a){if(a){var d={},c;for(c in a)a.hasOwnProperty(c)&&(b.b.Az(a[c],this.attributes[c])||(d[c]=a[c]));return b.b.ih(d)?!1:d}return b.b.ih(this.changed)?!1:this.changed};b.b.g("Model.prototype.changedAttributes",{GT:b.t.prototype.GT});b.t.prototype.NU=function(a){return void 0!==a?b.t.KG(this.changed)&&this.changed.hasOwnProperty(a):b.t.KG(this.changed)};b.b.g("Model.prototype.hasChanged",{NU:b.t.prototype.NU});b.t.prototype.destroy=function(a){a=a||{};var d=a.wait,c,e=a.error,
g=this,h,k;k=b.t.Qs(a);c=b.t.D3(k);var f=this.Ly();k.success=function(e){k.xhr&&(a.xhr=k.xhr);if(f){var h=b.Ra.oe(e)&&!b.Ra.ih(e)?JSON.parse(e):e;f.n8(h,null,e,!0)}d&&g.GO();b.t.TF(g,e,k);c&&c.call(b.t.Qk(k,g),g,e,a)};k.error=function(d,c,h){g.mc(!1,b.ba.N.ERROR,g,d,a);e&&e.apply(g,arguments)};if(!this.wJ())return h=b.t.OA("delete",this,k),d||this.GO(),h;d||this.GO();c&&c.call(b.t.Qk(k,g),g,null,a);return!1};b.b.g("Model.prototype.destroy",{destroy:b.t.prototype.destroy});b.t.prototype.b2=function(a,
d,c,e){this.mc(e,b.ba.N.REQUEST,a,d,c)};b.t.prototype.GO=function(){this.mc(!1,b.ba.N.DESTROY,this,this.collection,null)};b.t.TF=function(a,d,c){a.mc(!1,b.ba.N.SYNC,a,d,c)};b.t.prototype.toJSON=function(){var a={},b;for(b in this.attributes)this.attributes.hasOwnProperty(b)&&(Array.isArray(this.attributes[b])?a[b]=this.attributes[b].slice(0):a[b]=this.attributes[b]);return a};b.b.g("Model.prototype.toJSON",{toJSON:b.t.prototype.toJSON});b.t.prototype.oD=function(a){return this.SV[a]};b.b.g("Model.prototype.previous",
{oD:b.t.prototype.oD});b.t.prototype.Qca=function(){return this.SV};b.b.g("Model.prototype.previousAttributes",{Qca:b.t.prototype.Qca});b.t.prototype.sync=function(a,b,c){return window.oj.sync(a,b,c)};b.t.OA=function(a,d,c){c=c||{};d.oauth&&(c.oauthHeader=d.oauth.getHeader());!c.dataType&&d.dataType&&(c.dataType=d.dataType);!c.jsonpCallback&&d.jsonpCallback&&(c.jsonpCallback=d.jsonpCallback);if("create"===a||"patch"===a||"update"===a)c.OV=d.parseSave.call(d,"patch"===a?c.attrs:c.saveAttrs);var e=
null;d instanceof b.t&&(e=d.wh());var g={};if(c)for(var h in c)g[h]=c[h];e=b.t.LX(e,d,c);for(h in e)g[h]=e[h];c.xhr=d.sync(a,d,g);g.xhr&&(c.xhr=g.xhr);return c.xhr};b.t.LX=function(a,d,c){d=d instanceof b.j?d.efa(c):{};a&&(d.recordID=a);return d};b.sW=function(a,d,c){function e(a){d.b2(d,a,c,c.silent);return a}c=c||{};var g,h=c.success,k=c.error;g=d.customURL;if("create"===a.valueOf())return a=(a=d.Fua())?a:b.t.Fp(d,"url"),g=new b.ob(a,g),e(g.gxa(c.OV,k,c,d));if("read"===a.valueOf()){if(d instanceof
b.t)return a=c.url?c.url:b.t.Fp(d,"url"),g=new b.ob(a,g),e(g.xU(h,k,d.wh(),c,b.t.Qk(c,d)));a=d.$W(c);g=new b.ob(a,g);return e(g.bza(h,k,c,d))}g=new b.ob(b.t.Fp(d,"url"),g);var f=null;d instanceof b.t&&(f=d.wh());return"update"===a.valueOf()?e(g.iea(h,f,c.OV,k,c,d,!1)):"patch"===a.valueOf()?e(g.iea(h,f,c.OV,k,c,d,!0)):"delete"===a.valueOf()?e(g.tya(f,k,c,d)):null};o_("sync",b.sW,b);b.t.Vwa=function(a){if(!a.url)throw Error("The url property or function must be specified");};b.ajax=function(){arguments&&
0<arguments.length&&b.t.Vwa(arguments[0]);return f.ajax.apply(window.oj,arguments)};o_("ajax",b.ajax,b);b.Np=function(){this.name="URLError";this.message="No URL defined"};o_("URLError",b.Np,b);b.Np.prototype=Error();b.Np.constructor=b.Np;b.ob=function(a,b){this.rD=a;this.Cl=b;f.support.cors=!0};b.ob.Cv="headers";b.ob.gC=function(a,d,c){var e;a=f.extend(!0,a,c);for(e in d)d.hasOwnProperty(e)&&"oauthHeader"!==e&&(a.hasOwnProperty(e)||(a[e]=d[e]),e===b.ob.Cv&&(a[e]=f.extend(!0,a[e],d[e])));if(d.oauthHeader)for(e in a[b.ob.Cv]||
(a[b.ob.Cv]={}),d.oauthHeader)d.oauthHeader.hasOwnProperty(e)&&(a[b.ob.Cv].hasOwnProperty(e)||(a[b.ob.Cv][e]=d.oauthHeader[e]));return a};b.ob.prototype.bza=function(a,d,c,e){c=c||{};var g="jsonp"===c.dataType,h=this.DA("read",this.rD,this.Cl,null,e,c);a={crossDomain:c.crossDomain||!g,dataType:this.eG(c),jsonpCallback:c.jsonpCallback,context:null!==e?e:this,success:a,error:d};a=this.SE(a);a=b.ob.gC(a,c,h);c.xhr=this.ajax(a);return c.xhr};b.ob.prototype.SE=function(a){a[b.ob.Cv]={"Accept-Language":this.Sh()};
return a};b.ob.prototype.xU=function(a,d,c,e,g){e=e||{};var h="jsonp"===e.dataType;c=this.DA("read",this.rD,this.Cl,c,g,e);a={crossDomain:e.crossDomain||!h,dataType:this.eG(e),jsonpCallback:e.jsonpCallback,context:null!==g?g:this,success:a,error:d};a=this.SE(a);a=b.ob.gC(a,e,c);e.xhr=this.ajax(a);return e.xhr};b.ob.prototype.iea=function(a,d,c,e,g,h,k){g=g||{};var f="jsonp"===g.dataType;d=this.DA(k?"patch":"update",this.rD,this.Cl,d,h,g);k=b.ob.fw(g);a={crossDomain:g.crossDomain||!f,contentType:this.bna(g),
dataType:this.eG(g),jsonpCallback:g.jsonpCallback,data:this.zb(JSON.stringify(c),g,d),emulateHTTP:k,emulateJSON:b.ob.gw(g),success:a,error:e,context:null!==h?h:this};a=this.SE(a);a=b.ob.gC(a,g,d);a=b.ob.J_(k,a);g.xhr=this.ajax(a);return g.xhr};b.ob.J_=function(a,b){if(a){var c=b.beforeSend;b.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",b.fk);if(c)return c.apply(this,arguments)}}return b};b.ob.prototype.zb=function(a,d,c){return b.ob.gw(d)?(d={_method:c.fk?c.fk:c.type},a&&(d.model=
a),d):a};b.ob.prototype.tna=function(a,d){if(d.type)return{method:d.type};var c=null;"create"===a&&(c="POST");"delete"===a&&(c="DELETE");"patch"===a&&(c="PATCH");"update"===a&&(c="PUT");if(b.ob.fw(d)){var e={method:"POST"};e.fk=c;return e}null===c&&(c="GET");return{method:c}};b.ob.fw=function(a){return a.emulateHTTP||b.emulateHTTP};b.ob.gw=function(a){return a.emulateJSON||b.emulateJSON};b.ob.prototype.DA=function(a,d,c,e,g,h){var k=this.tna(a,h);if(f.isFunction(c)){a=c.call(this,a,g,b.t.LX(e,g,h));
if(b.Ra.oe(a))return d={url:a,type:k.method},k.fk&&(d.fk=k.fk),d;if(a)return a.url=a.hasOwnProperty("url")?a.url:d,a.hasOwnProperty("type")||(a.type=k.method),!a.hasOwnProperty("data")&&k.fk&&(a.fk=k.fk),a}d={url:b.t.Fp(null,d),type:k.method};k.fk&&(d.fk=k.fk);return d};b.ob.prototype.tya=function(a,d,c,e){c=c||{};var g="jsonp"===c.dataType;a=this.DA("delete",this.rD,this.Cl,a,e,c);var h=b.ob.fw(c);d={crossDomain:c.crossDomain||!g,success:c.success,error:d,context:null!==e?e:this,emulateHTTP:h,emulateJSON:b.ob.gw(c)};
(e=this.zb(null,c,a))&&(d.data=e);d=b.ob.gC(d,c,a);d=b.ob.J_(h,d);c.xhr=this.ajax(d);return c.xhr};b.ob.prototype.gxa=function(a,d,c,e){c=c||{};var g=JSON.stringify(a),h="jsonp"===c.dataType;a=this.DA("create",this.rD,this.Cl,null,e,c);var k=b.ob.fw(c);d={crossDomain:c.crossDomain||!h,contentType:c.contentType||"application/json",dataType:this.eG(c),jsonpCallback:c.jsonpCallback,data:this.zb(g,c,a),success:c.success,error:d,emulateHTTP:k,emulateJSON:b.ob.gw(c),context:null!==e?e:this};d=this.SE(d);
d=b.ob.gC(d,c,a);c.xhr=this.ajax(d);return c.xhr};b.ob.prototype.eG=function(a){return b.ob.gw(a)&&!b.ob.fw(a)?"application/x-www-form-urlencoded":a.dataType||"json"};b.ob.prototype.bna=function(a){return b.ob.gw(a)&&!b.ob.fw(a)?"application/x-www-form-urlencoded":a.contentType||"application/json"};b.ob.prototype.Sh=function(){return b.ha.Sh()};b.ob.prototype.ajax=function(a){if(null===a.url||void 0===a.url)throw new b.Np;return window.oj.ajax(a)};b.gc=function(a,d){d=d||{};b.gc._init(this,d,a||"Authorization")};
o_("OAuth",b.gc,b);b.b.la(b.gc,b.b,"oj.OAuth");b.gc.prototype.Init=function(){b.gc.p.Init.call(this)};b.gc.prototype.oaa=function(){var a={};this.br.access_token||this.IT();a[this.Um.Y9]="Bearer "+this.br.access_token;return a};b.b.g("OAuth.prototype.getHeader",{oaa:b.gc.prototype.oaa});b.gc.prototype.Nba=function(){return this.br.RDa?!0:!1};b.b.g("OAuth.prototype.isInitialized",{Nba:b.gc.prototype.Nba});b.gc.prototype.IT=function(){var a={},d=this;a[d.Um.Y9]="Basic "+b.gc.lja(d.Um.client_id+":"+
d.Um.client_secret);f.ajax({type:"POST",async:!1,url:this.Um.bearer_url,data:"grant_type\x3dclient_credentials",headers:a,success:function(a){b.gc.NA(d.br,a)},error:function(a){throw Error(a.responseText);}})};b.b.g("OAuth.prototype.clientCredentialGrant",{IT:b.gc.prototype.IT});b.gc.prototype.tda=function(a){b.gc.NA(this.br,a)};b.b.g("OAuth.prototype.setAccessTokenResponse",{tda:b.gc.prototype.tda});b.gc.prototype.V$=function(){return this.br};b.b.g("OAuth.prototype.getAccessTokenResponse",{V$:b.gc.prototype.V$});
b.gc.prototype.i$=function(){b.gc.e0(this.br)};b.b.g("OAuth.prototype.cleanAccessTokenResponse",{i$:b.gc.prototype.i$});b.gc.prototype.sda=function(a){b.gc.NA(this.Um,a)};b.b.g("OAuth.prototype.setAccessTokenRequest",{sda:b.gc.prototype.sda});b.gc.prototype.U$=function(){return this.Um};b.b.g("OAuth.prototype.getAccessTokenRequest",{U$:b.gc.prototype.U$});b.gc.prototype.h$=function(){b.gc.e0(this.Um)};b.b.g("OAuth.prototype.cleanAccessTokenRequest",{h$:b.gc.prototype.h$});b.gc._init=function(a,d,
c){a.Init();a.Um={};a.br={};d.access_token?b.gc.NA(a.br,d):d.client_id&&d.client_secret&&d.bearer_url&&b.gc.NA(a.Um,d);a.Um.Y9=c};b.gc.NA=function(a,b){var c;b=b||{};for(c in b)a[c]=b[c]};b.gc.e0=function(a){for(var b in a)a.hasOwnProperty(b)&&"auth_header"!==b&&(a[b]=null,delete a[b])};b.gc.lja=function(a){var b,c,e,g,h=0,k=0,f=[];do b=a.charCodeAt(h++),c=a.charCodeAt(h++),e=a.charCodeAt(h++),g=b<<16|c<<8|e,b=g>>18&63,c=g>>12&63,e=g>>6&63,g&=63,f[k++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(b)+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(e)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(g);while(h<a.length);f=f.join("");b=a.length%3;return(b?f.slice(0,b-3):f)+"\x3d\x3d\x3d".slice(b||3)};b.j=function(a,d){b.j.XA||b.j._init(this,a,d,null)};o_("Collection",b.j,b);b.b.la(b.j,b.b,"oj.Collection");b.j.prototype.Hr=null;b.b.g("Collection.prototype.model",
{Hr:b.j.prototype.Hr});b.j.prototype.uca=function(a){var b=this.model;return b&&a?a[b.idAttribute||b.prototype.idAttribute||"id"]:null};b.b.g("Collection.prototype.modelId",{uca:b.j.prototype.uca});b.j.prototype.length=void 0;b.b.g("Collection.prototype.length",{length:b.j.prototype.length});b.j.prototype.wca=void 0;b.b.g("Collection.prototype.models",{wca:b.j.prototype.wca});b.j.prototype.Cc=[];b.j.prototype.url=null;b.b.g("Collection.prototype.url",{url:b.j.prototype.url});b.j.prototype.gr=[];b.b.g("Collection.prototype.changes",
{gr:b.j.prototype.gr});b.j.prototype.Cl=null;b.b.g("Collection.prototype.customURL",{Cl:b.j.prototype.Cl});b.j.prototype.C$=null;b.b.g("Collection.prototype.customPagingOptions",{C$:b.j.prototype.C$});b.j.prototype.Uba=void 0;b.b.g("Collection.prototype.lastFetchSize",{Uba:b.j.prototype.Uba});b.j.prototype.uba=!1;b.b.g("Collection.prototype.hasMore",{uba:b.j.prototype.uba});b.j.prototype.Wda=void 0;b.b.g("Collection.prototype.totalResults",{Wda:b.j.prototype.Wda});b.j.prototype.Tba=void 0;b.b.g("Collection.prototype.lastFetchCount",
{Tba:b.j.prototype.Tba});b.j.prototype.vca=-1;b.b.g("Collection.prototype.modelLimit",{vca:b.j.prototype.vca});b.j.prototype.offset=void 0;b.b.g("Collection.prototype.offset",{offset:b.j.prototype.offset});b.j.prototype.K$=-1;b.b.g("Collection.prototype.fetchSize",{K$:b.j.prototype.K$});b.j.prototype.mW=1;b.b.g("Collection.prototype.sortDirection",{mW:b.j.prototype.mW});b.j.prototype.KT=null;b.b.g("Collection.prototype.comparator",{KT:b.j.prototype.KT});b.j.prototype.Init=function(){b.j.p.Init.call(this)};
b.j.extend=function(a,d){b.j.XA=!0;var c=new b.j;b.j.XA=!1;f.extend(c,this.prototype);var e;e=a&&a.constructor&&a.hasOwnProperty("constructor")?a.constructor:function(d,c){b.j._init(this,d,c,a)};if(d)for(var g in d)d.hasOwnProperty(g)&&(e[g]=d[g]);if(a)for(g in a)a.hasOwnProperty(g)&&(c[g]=a[g]);f.extend(e,this);e.prototype=c;e.extend=b.j.extend;return e.prototype.constructor=e};o_("Collection.extend",b.j.extend,b);b.j._init=function(a,d,c,e){var g,h;a.Init();b.ba.gL(a);if(e)for(g in e)e.hasOwnProperty(g)&&
(a[g]=e[g]);c=c||{};h=["comparator","customPagingOptions","customURL",b.j.Oe,"model","modelLimit","sortDirection","url"];for(g=0;g<h.length;g++)c.hasOwnProperty(h[g])&&void 0!==c[h[g]]&&(a[h[g]]=c[h[g]]);void 0===a.Bm(null)&&a.oK(-1);void 0===a.modelLimit&&a.fW(-1);a.hasMore=!1;a.zk=0;a.Mt([],!0);c.parse&&(d=a.parse(d));if(null!=d)for(c.Cca=!0,h=d instanceof Array?d:[d],g=0;g<h.length;g+=1)a.add(h[g],c);a.Pm();e&&e.initialize&&e.initialize.call(a,d,c)};b.j.prototype.on=function(){};b.j.prototype.Kn=
function(){};b.j.prototype.mc=function(){};b.j.prototype.b2=function(a,d,c,e){this.mc(e,b.ba.N.REQUEST,a,d,c)};b.j.prototype.pua=function(){this.changes=[]};b.j.prototype.lS=function(a,b){for(var c=a;c<a+b;c++)-1===this.changes.indexOf(c)&&(this.changes.push(c),this.changes.sort(function(a,b){return a-b}))};b.j.prototype.Mt=function(a,b){this.models=a;if(b)this.Cc=[],this.pua();else for(var c=0;c<a.length;c++)a[c]&&this.Cc.push(c)};b.j.prototype.qd=function(){return this.models};b.j.prototype.Vd=
function(){return this.qd().length};b.j.prototype.zsa=function(a){return a<this.Vd()||this.tb()&&(!this.st()||0===this.Vd())?!1:!0};b.j.prototype.st=function(){return b.j.Zn(this.totalResults)};b.j.Zn=function(a){return null!=a};b.j.prototype.eta=function(a){this.qd().push(a);this.Cc.push(this.Vd()-1);this.lS(this.Vd()-1,1)};b.j.prototype.fta=function(a){this.iR(a);this.eta(a);this.zk++;a.Zy(this.Vd()-1)};b.j.prototype.J6=function(a){if(a)for(var b=0;b<a.length;b++)a[b]&&this.zk--};b.j.prototype.R8=
function(a,b,c){for(var e=a;e<a+b;e++)this.n7(this.sc(e));void 0===c?(this.J6(this.qd().splice(a,b)),this.Q8(a,a+b-1)):(this.J6(this.qd().splice(a,b,c)),this.Q8(a,a+b-1),this.Kqa(a),this.iR(c));this.lS(a,b);0>this.zk&&(this.zk=0);this.I6(a)};b.j.prototype.sc=function(a){return this.qd()[a]};b.j.prototype.I6=function(a){for(var b,c=0;c<this.Cc.length;c++)b=this.Cc[c],b>=a&&this.sc(b)&&this.sc(b).Zy(b)};b.j.prototype.n7=function(a){if(a){var b=a.TV;a=a.eBa;b?b.qL(a):this.head=a;a?a.SD(b):this.tail=
b}};b.j.prototype.iR=function(a){a.qL(this.head);this.head?this.head.SD(a):this.tail=a;a.SD(null);this.head=a};b.j.prototype.ova=function(a){-1===this.Cc.indexOf(a)&&this.Cc.push(a)};b.j.prototype.Kqa=function(a){for(var b=0;b<this.Cc.length;b++)this.Cc[b]>=a&&this.Cc[b]++;this.Cc.push(a)};b.j.prototype.Q8=function(a,b){void 0===b&&(b=a);this.n0(a,b);for(var c=b-a+1,e=0;e<this.Cc.length;e++)this.Cc[e]>b&&(this.Cc[e]-=c)};b.j.prototype.n0=function(a,b){void 0===b&&(b=a);for(var c=a;c<=b;c++){var e=
this.Cc.indexOf(a);-1<e&&this.Cc.splice(e,1)}};b.j.prototype.QH=function(a,b){var c=this.sc(a);this.n7(c);c||this.zk++;this.lS(a,1);if(this.qd()[a]=b)this.ova(a),b.Zy(a),this.iR(b)};b.j.prototype.cka=function(a){var b=this.tail,c,e,g=0;for(this.tail=null;b&&g<a;)c=b.Mea(),(e=this.sc(c))&&e.NU()?(this.tail||(this.tail=b),b=b.TV):(this.zk--,-1<c&&(this.QH(c,void 0),this.n0(c,c)),b.qL(null),b=b.SD(null),g++);this.tail||(this.tail=b);0>this.zk&&(this.zk=0);0===this.zk&&(this.tail=this.head=null)};b.j.prototype.HB=
function(){this.zk=0;this.tail=this.head=null};b.j.prototype.Ct=function(a){if(this.tb()){var b=this.b3();-1<b&&this.zk+a>b&&this.cka(this.zk+a-b)}};b.j.prototype.clone=function(){return this.r0(!0)};b.b.g("Collection.prototype.clone",{clone:b.j.prototype.clone});b.j.prototype.r0=function(a){var b=new this.constructor,c;this.tb()&&(b=this.yka(b),b.bS());b=this.zka(b);if(a){var e=[];for(a=0;a<this.Cc.length;a++)e.push(this.Cc[a]);e.sort(function(a,b){return a-b});var g;for(a=0;a<e.length;a++)g=e[a],
(c=this.Un(g,null,!0,!1))&&b.Sn(c.clone(),{at:g},!0,!1)}return b};b.j.prototype.zka=function(a){var b=["comparator","model","modelId"],c,e;for(e=0;e<b.length;e++)c=b[e],a[c]=this[c];return a};b.j.prototype.yka=function(a){var d=["totalResults","hasMore",b.j.Oe],c,e;for(e=0;e<d.length;e++)c=d[e],a[c]=this[c];return a};b.j.prototype.hf=function(){return this.length};b.j.prototype.Pm=function(){var a=this.Vd();this.length=a;this.tb()||(this.totalResults=a)};b.j.RN=function(a,b,c){return a.model?f.isFunction(a.model)?
new a.model(b,c):new a.model.constructor(b,c):null};b.j.prototype.iB=function(a,d,c){var e=null;d=d||{};d.tAa=c;a instanceof b.t?e=a:this.model?e=b.j.RN(this,a,d):(d.collection=this,e=new b.t(a,d));return d.validate&&e.validate&&(a=e.validate(e.attributes))?(d.validationError=a,this.mc(!1,b.ba.N.INVALID,e,a,d),null):e};b.j.prototype.add=function(a,b){this.Ct(1);return this.HA(this.Sn(a,b,!1,(b||{}).deferred))};b.b.g("Collection.prototype.add",{add:b.j.prototype.add});b.j.prototype.Sn=function(a,d,
c,e){function g(a,g,e,h,k){var f,l=null;!m&&u&&e?(w=e.afa(g,a.comparator,n),l=e):(m||(f=a.V2(h))&&c&&p!==f.index&&b.r.warn("Duplicate ID fetched or added without merging, the id \x3d "+f.wh()),void 0===f?(void 0===p?(a.fta(h),s=a.Vd()-1,a.sc(s).RD()):(s=p,a.tb()&&c?a.QH(s,h):a.R8(s,0,h),a.sc(s).RD(),p+=1),void 0===h.Ly()&&h.Yy(a),a.Pm(),a.Cra(h),t=!0,l=h):l=f);c&&(d=d||{},d.fillIn=!0);w&&void 0===f&&!v&&void 0===p&&1<a.hf()&&(-1<s&&(r=a.sc(s).cid),g={},b.Zc.sg(g,d),g.add=!0,a.sort(g),-1<s&&(s=a.tb()?
-1:a.indexOf(a.jU(r),k)));t&&(d.at&&(d.index=s),h?(h.mc(n,b.ba.N.ADD,h,a,d),x.push(h)):(e.mc(n,b.ba.N.ADD,e,a,d),x.push(e)));return l}function h(a,e,h){t=!1;var k=a.iB(e,d,!1),f=null,r=null;if(null!=k){s=-1;k.fm();f=e instanceof b.t?e:k;if(h)return m?new Promise(function(b){var d=g(a,f,void 0,k,h);y.push(d);b(d)}):a.jj(f,{silent:!0},h,!0).then(function(b){r=b.m;b=g(a,f,r,k,h);y.push(b)});!m&&u&&(r=c?a.V2(f):a.get(f));(e=g(a,f,r,k,h))&&y.push(e)}else y.push(!1)}function k(a,b){return a.parse&&d.parse&&
!d.Cca?a.parse(b):b}d=d||{};var f=[],p=d.at,n=d.silent,m=d.force,q,s,r,u=d.merge||!1,v=d.sort,w=!0,t=!1,x=[],y=[];void 0!==p&&0>p&&(p+=this.hf()+1);a instanceof Array?f=a:f.push(a);if(!c&&(this.tb()||e)){var B=this;return new Promise(function(a,c){function g(a){return new Promise(function(b,d){h(B,f[a],!0).then(function(){b(a+1)},d)})}var e=Promise.resolve(0);f=k(B,f);for(q=0;q<f.length;q++)e=e.then(g);e.then(function(){0<x.length&&B.mc(d.silent,b.ba.N.ALLADDED,B,x,d);a(b.j.dS(y))},c)})}f=k(this,
f);for(q=0;q<f.length;q++)h(this,f[q],!1);0<x.length&&this.mc(d.silent,b.ba.N.ALLADDED,this,x,d);return b.j.dS(y)};b.j.dS=function(a){return 1===a.length?a[0]:a};b.j.prototype.IG=function(){return b.j.Zn(this.comparator)};b.j.prototype.sort=function(a){a=a||{};var d=a.silent,c=this.comparator,e;if(!this.IG())return null;if(this.tb()){var g=this.totalResults;this.st()?this.Mt(Array(g),!0):(this.Mt([],!0),this.HB(),this.Pm());g=a.add?{add:!0}:null;this.mc(d,b.ba.N.SORT,this,g,null);d=a.startIndex;return void 0!==
d&&null!==d?this.tD(d,this.Bm(a)):null}e=this;this.qd().sort(function(a,d){return b.j.SX(a,d,c,e,e)});this.I6(0);g=a.add?{add:!0}:null;this.mc(d,b.ba.N.SORT,this,g,null);return null};b.b.g("Collection.prototype.sort",{sort:b.j.prototype.sort});b.j.Ab=function(a,d){return a instanceof b.t?a.get(d):b.t.Fp(a,d)};b.j.SX=function(a,d,c,e,g){var h,k,l;if(f.isFunction(c)){if(1===c.length){h=c.call(g,a);k=c.call(g,d);h=b.Ra.oe(h)?h.split(","):[h];var p=b.Ra.oe(k)?k.split(","):[k];for(l=0;l<h.length;l++)if(k=
b.j.Wn(h[l],p[l],e.sortDirection),0!==k)return k}return c.call(g,a,d)}if(b.Ra.oe(c))for(c=c.split(","),l=0;l<c.length;l++)if(h=b.j.Ab(a,c[l]),k=b.j.Ab(d,c[l]),k=b.j.Wn(h,k,e.sortDirection),0!==k)return k;return 0};b.j.prototype.Kda=function(a,d){var c=d?d:this.comparator,e;if(!c)return-1;this.Yg("sortedIndex");e=this;return b.j.Ama(this.qd(),a,function(a,d){var k,l;if(f.isFunction(c)){if(1===c.length){k=c.call(e,a);l=c.call(e,d);k=b.Ra.oe(k)?k.split(","):[k];l=b.Ra.oe(l)?l.split(","):[l];var p,n;
for(n=0;n<k.length;n++)if(p=b.j.Wn(k[n],l[n],e.sortDirection),0!==p)return p}return c.call(e,a,d)}return b.Ra.oe(c)?(k=a.get(c),l=d.get(c),b.j.Wn(k,l,e.sortDirection)):0})};b.b.g("Collection.prototype.sortedIndex",{Kda:b.j.prototype.Kda});b.j.Ama=function(a,b,c){function e(g,h){var k,f;if(g>h)return-1;k=b.bs();f=b.wh();if(a[g].hs(f,k))return g;if(a[h].hs(f,k))return h;k=Math.floor((h+g)/2);return-1===c(a[k],b)?e(g+1,k):1===c(a[k],b)?e(k,h-1):k}return e(0,a.length-1)};b.j.Wn=function(a,b,c){if(-1===
c){if(a<b)return 1;if(b<a)return-1}else{if(a>b)return 1;if(b>a)return-1}return 0};b.j.prototype.unshift=function(a,d){var c={};b.Zc.sg(c,d||{});c.at||(c.at=0);this.Ct(1);return this.HA(this.Sn(a,c,!1,c.deferred))};b.b.g("Collection.prototype.unshift",{unshift:b.j.prototype.unshift});b.j.prototype.HA=function(a){return f.isFunction(a.then)?this.df(function(){return a}):a};b.j.prototype.shift=function(a){a=a||{};var d=this.Qg(a),c;if(this.tb()||d){var e=this;return this.at(0,a).then(function(d){c=e.Kt(d,
0,a);e.mc(a.silent,b.ba.N.ALLREMOVED,e,[c],a);return c})}c=this.Kt(this.at(0),0,a);this.mc(a.silent,b.ba.N.ALLREMOVED,this,[c],a);return c};b.b.g("Collection.prototype.shift",{shift:b.j.prototype.shift});b.j.prototype.rJ=function(a){void 0===a&&(a=1);this.Yg("initial");var b=[],c;for(c=0;c<this.hf()-a;c+=1)b.push(this.at(c));return b};b.b.g("Collection.prototype.initial",{rJ:b.j.prototype.rJ});b.j.prototype.Qg=function(a){return(a||{}).deferred};b.j.prototype.last=function(a,b){var c=this.Qg(b);void 0===
a&&(a=1);if(1===a){var e=this.Vd();0===e&&(e=a);return 0<e?this.at(e-1,c):null}var g=[],e=this.hf();if(c||this.tb()){var h=e-a;0>h&&(h=0);0===e&&(e=a);var k=this;return this.df(function(){return k.hv(h,e)})}for(c=e-a;c<e;c+=1)g.push(this.at(c));return g};b.b.g("Collection.prototype.last",{last:b.j.prototype.last});b.j.prototype.hv=function(a,b){var c=[],e,g=this;return new Promise(function(h,k){function f(a){return new Promise(function(b,d){g.bO(a,null).then(function(d){c.push(d);b(a+1)},d)})}var p=
Promise.resolve(a);for(e=a;e<b;e++)p=p.then(f);p.then(function(){h(c)},k)})};b.j.prototype.B2=function(a){return void 0===a||null===a?this[b.j.Oe]:a};b.j.prototype.Kja=function(){var a=this.lastFetchCount;if(void 0===a||null===a)a=this[b.j.Oe];return void 0===this.offset||null===this.offset?a:this.offset+a};b.j.prototype.next=function(a,d){d=d||{};d[b.j.Oe]=this.B2(a);var c=this.Kja(),e=this.hf();if(0===e&&0<d[b.j.Oe])c=0;else if(c>=e)return d.success&&d.success.call(b.t.Qk(d,this),this,null,d),null;
d.startIndex=c;return this.fetch(d)};b.b.g("Collection.prototype.next",{next:b.j.prototype.next});b.j.prototype.Lja=function(a){return void 0===this.offset||null===this.offset?0:this.offset-a};b.j.prototype.oD=function(a,d){d=d||{};if(0===this.offset)return d.success&&this.lastFetchCount&&d.success.call(b.t.Qk(d,this),this,null,d),null;d[b.j.Oe]=this.B2(a);var c=this.Lja(d[b.j.Oe]);0>c&&(d[b.j.Oe]=this.offset,c=0);d.startIndex=c;return this.fetch(d)};b.b.g("Collection.prototype.previous",{oD:b.j.prototype.oD});
b.j.prototype.fW=function(a){this.modelLimit=a;this.Ct(0)};b.b.g("Collection.prototype.setModelLimit",{fW:b.j.prototype.fW});b.j.prototype.b3=function(){return this.modelLimit};b.j.prototype.oK=function(a){this[b.j.Oe]=a};b.b.g("Collection.prototype.setFetchSize",{oK:b.j.prototype.oK});b.j.prototype.nda=function(a,b){var c=this.Qg(b);void 0===a&&(a=1);var e=[];if(this.tb()||c){var g=this;return this.df(function(){return g.hv(a,g.hf())})}for(c=a;c<this.hf();c+=1)e.push(this.at(c));return e};b.b.g("Collection.prototype.rest",
{nda:b.j.prototype.nda});b.j.prototype.remove=function(a,d){d=d||{};var c=[],e;a instanceof Array?c=a:c.push(a);var g=[];for(e=c.length-1;0<=e;e-=1)g.unshift(this.Kt(c[e],-1,d));this.mc(d.silent,b.ba.N.ALLREMOVED,this,c,d);return b.j.dS(g)};b.b.g("Collection.prototype.remove",{remove:b.j.prototype.remove});b.j.prototype.Kt=function(a,d,c){c=c||{};a=-1==d?this.jj(a):b.j.jo(d,a);var e=c.silent;d=a.index;if(-1<d){var g=a.m;void 0!==g&&g.Ly()===this&&g.Yy(null);this.R8(d,1);this.Pm();var h={};b.Zc.sg(h,
c);h.index=d;void 0!==g&&g.mc(e,b.ba.N.REMOVE,g,this,h);this.y9(g)}return a.m};b.j.prototype.y9=function(a){void 0!==a&&a.off(null,null,this)};b.j.prototype.Cra=function(a){a.Kn(b.ba.N.ALL,this.Zra,this,!1,!0)};b.j.prototype.Zra=function(a,d,c,e){a===b.ba.N.DESTROY&&this.remove(d);void 0!==c&&c instanceof b.j&&c!==this||(Array.prototype.slice.call(arguments),this.mc(e&&e.silent,a,d,c,e))};b.j.prototype.refresh=function(a){a=a||{};var d=this;return this.df(function(){return new Promise(function(c,
e){if(!d.tb()){var g=void 0!==a.silent&&a.silent;try{d.reset(null,{silent:!0});var h={},k;for(k in a)a.hasOwnProperty(k)&&(h[k]=a[k]);h.success=function(a,e,h){d.mc(g,b.ba.N.REFRESH,d,h,null);c({collection:a,response:e,options:h})};h.error=function(c,g,h){e(b.j.cA(c,g,h,d,a))};d.fetch(h);return}catch(f){if(f instanceof b.Np){d.mc(g,b.ba.N.REFRESH,d,a,null);c({collection:d,options:a});return}throw f;}}h=a.startIndex;d.Mt([],!0);d.HB();d.totalResults=void 0;d.Pm();g=void 0!==a.silent&&a.silent;d.mc(g,
b.ba.N.REFRESH,d,a,null);if(void 0===h||null===h)h=0;void 0!==h&&null!==h?d.r8(h,d.Bm(a)).then(function(a){c(a)},function(a){e(a)}):c(void 0)})})};b.b.g("Collection.prototype.refresh",{refresh:b.j.prototype.refresh});b.j.prototype.reset=function(a,d){var c={};b.Zc.sg(c,d||{});c.previousModels=this.qd();for(var e,g=0;g<this.Cc.length;g++)if(e=this.Cc[g],e=this.sc(e))this.y9(e),e.Yy(null);this.Mt([],!0);this.HB();g=void 0!==c.silent&&c.silent;if(!a)return this.totalResults=void 0,this.Pm(),this.mc(g,
b.ba.N.RESET,this,c,null),null;e=null;c.parse&&(a=this.parse(a));this.Ct(a instanceof Array?a.length:1);c.Cca=!0;e=this.Sn(a,c,!0,!1);this.Pm();this.mc(g,b.ba.N.RESET,this,c,null);return this.HA(e)};b.b.g("Collection.prototype.reset",{reset:b.j.prototype.reset});b.j.prototype.at=function(a,b){return this.Un(a,b,!1,this.Qg(b))};b.b.g("Collection.prototype.at",{at:b.j.prototype.at});b.j.prototype.Un=function(a,b,c,e){0>a&&(a+=this.hf());if(0>a||this.zsa(a))return c||!this.tb()&&!e?null:this.df(function(){return Promise.resolve(null)});
var g=this;return c||!this.tb()&&!e?this.sc(a):this.df(function(){return g.bO(a,b)})};b.j.prototype.whenReady=function(){return this.Pq?this.Pq:Promise.resolve()};b.b.g("Collection.prototype.whenReady",{whenReady:b.j.prototype.whenReady});b.j.prototype.df=function(a){var d=this;void 0===this.Pq&&(this.sB=0,this.Pq=Promise.resolve());this.sB++;return this.Pq=this.Pq.then(a.bind(d)).then(function(a){d.sB--;0===d.sB&&(d.Pq=void 0,d.mc(!1,b.ba.N.READY,d,null,null));return a},function(a){d.sB--;0===d.sB&&
(d.Pq=void 0);return Promise.reject(a)})};b.j.prototype.bO=function(a,d){var c=this,e=c.sc(a);return void 0===e?new Promise(function(g,e){var k={};b.Zc.sg(k,d||{});k.context=c;k.startIndex=a;k.error=function(a,g,k){e(b.j.cA(a,g,k,c,d))};k.success=function(){g(c.sc(a))};c.Lf(k,-1,!1)}):new Promise(function(a){a(e)})};b.j.prototype.jU=function(a){for(var b=this.qd(),c,e=null,g=0;g<this.Cc.length;g++)if(c=this.Cc[g],b[c]&&a===b[c].cid){e=b[c];break}if(e)return e;if(this.tb())throw Error("Not found locally and not supported by server for virtual collections");
return null};b.b.g("Collection.prototype.getByCid",{jU:b.j.prototype.jU});b.j.prototype.get=function(a,b){var c=this.jj(a,b,this.Qg(b));if(c){if(f.isFunction(c.then))return this.df(function(){return new Promise(function(a,b){c.then(function(b){a(b.m)},function(a){b(a)})})});if(this.tb())return this.df(function(){return new Promise(function(a){a(c.m)})});if(c.hasOwnProperty("m"))return c.m}return null};b.b.g("Collection.prototype.get",{get:b.j.prototype.get});b.j.prototype.V2=function(a){return(a=
this.W2(a))?a.m:null};b.j.prototype.W2=function(a){var d=a;a instanceof b.t?(d=a.bs(),a=a.wh()):b.j.Zn(a)&&void 0!==a.id&&(a=a.id);for(var c=null,e=this.Cc.length,g,h=this.qd(),k,f=0;f<e;f++)if(k=this.Cc[f],g=h[k],void 0!==g&&g.hs(a,d)){c=b.j.jo(k,g);break}return c?c:b.j.jo(-1,void 0)};b.j.prototype.jj=function(a,d,c,e){var g=a;void 0===e&&(e=!1);a instanceof b.t?(g=a.bs(),a=a.wh()):b.j.Zn(a)&&void 0!==a.id&&(a=a.id);for(var h=null,k=this.qd(),f,p=0;p<this.Cc.length;p++)if(f=this.Cc[p],k[f]&&k[f].hs(a,
g)){h=b.j.jo(f,k[f]);break}if(h)return c?new Promise(function(a){a(h)}):h;if(this.tb()){if(void 0===a&&void 0!==g)return new Promise(function(a){a(b.j.jo(-1,void 0))});var n=this;return new Promise(function(c,h){var k={};b.Zc.sg(k,d||{});k.context=n;k.startID=a;k.error=function(a,c,g){h(b.j.cA(a,c,g,n,d))};k.success=function(d,e){if(null!=e){var h=n.uP(),k=n.sc(h);void 0!==k&&k.hs(a,g)?c(b.j.jo(h,k)):c(b.j.jo(-1,void 0))}else c(b.j.jo(-1,void 0))};n.Lf(k,-1,e)})}var m=b.j.jo(-1,void 0);return c?new Promise(function(a){a(m)}):
m};b.j.jo=function(a,b){return{index:a,m:b}};b.j.prototype.parse=function(a){var b;if(a instanceof Array||!a)return a;for(b in a)if(a.hasOwnProperty(b)&&a[b]instanceof Array)return a[b];return a};b.j.prototype.Pja=function(a,b,c){return this.st()&&0<this.totalResults&&c.start+c.count>=this.totalResults?!0:c.start===a&&c.count===b};b.j.prototype.tD=function(a,b){var c=this;return this.df(function(){return c.r8(a,b)})};b.b.g("Collection.prototype.setRangeLocal",{tD:b.j.prototype.tD});b.j.prototype.r8=
function(a,b){this.tb()&&this.bS();var c=this.oG(a,b),e=this;if(this.Pja(a,b,c))return new Promise(function(a){a(c)});var g=this.b3();-1<g&&g<b&&(this.modelLimit=b);return new Promise(function(c,g){e.q8(a,b,-1,{start:a,count:b},c,g,!0)})};b.j.prototype.q8=function(a,d,c,e,g,h,k){var f=this,p=a+d;this[b.j.Oe]&&this[b.j.Oe]>d&&(p=this[b.j.Oe]+a);var n=null;this.tb()?(n=this.G2(a,p),n>a&&(a=n,p=a+d,this[b.j.Oe]&&this[b.j.Oe]>d&&(p=this[b.j.Oe]+a)),n={context:this,startIndex:a,fetchSize:p-a}):n={context:this};
n.error=function(a,d,c){h(b.j.cA(a,d,c,f,null))};n.success=function(){var b=f.oG(e.start,e.count);if(k&&f.st()&&b.count<e.count){var c=b.start+b.count,r=a+d;r<f.totalResults?f.q8(r,d,c,e,g,h,k):g(b)}else g(b)};try{this.Lf(n,c,-1<c)}catch(m){m instanceof b.Np&&(c=f.oG(a,d),g(c))}};b.j.cA=function(a,d,c,e,g){var h=!1;g&&g.silent&&(h=g.silent);b.t.YB(e,h,g,d,c,a);g=Error(d);g.xhr=a;g.error=c;g.collection=e;g.status=d;return g};b.j.prototype.Jna=function(a,b){var c=this.Vd();return 0===c?a+b:a+b>c?c:
a+b};b.j.prototype.Pba=function(a,b){var c=this.oG(a,b);return 0===this.Vd()?0===b:a===c.start&&(b===c.count||a+b>this.Vd())};b.b.g("Collection.prototype.isRangeLocal",{Pba:b.j.prototype.Pba});b.j.prototype.yA=function(a,b){for(var c=[],e=this.qd(),g=a+b,h=a;h<g;h++)c.push(e[h]);return c};b.j.prototype.oG=function(a,b){if(!this.tb()){if(0<this.Vd()){if(a+b>this.Vd()){var c=this.Vd()-a;return{start:a,count:c,models:this.yA(a,c)}}return{start:a,count:b,models:this.yA(a,b)}}return{start:a,count:0,models:[]}}c=
this.Jna(a,b);if(!this.st()&&c<a+b)return{start:a,count:c-a,models:this.yA(a,c-a)};if(0===c)return{start:a,count:0,models:[]};var e=this.G2(a,c);if(-1<e)return{start:a,count:e-a,models:this.yA(a,e-a)};a>c?b=0:a+b>c&&(b=c-a);return{start:a,count:b,models:this.yA(a,b)}};b.j.prototype.G2=function(a,b){for(var c=a;c<b;c++)if(void 0===this.sc(c))return c;return-1};b.j.prototype.fetch=function(a){var b=this.Lf(a,-1,!1);this.df(function(){return Promise.resolve(b)});return b};b.b.g("Collection.prototype.fetch",
{fetch:b.j.prototype.fetch});b.j.prototype.Lf=function(a,d,c){function e(a,b,d){a.tb()?d||a.bS():b.add||b.DW||a.reset(null,{silent:!0})}var g=a||{},h=g.success,k,f=g.error;g.set&&(g.DW=g.set?!0:!1);void 0===g.parse&&(g.parse=!0);k=this;g.error=function(d,c,g){b.t.YB(k,!1,a,c,g,d);f&&f.call(b.t.Qk(a,k),d,c,g)};g.success=function(f){var l;try{l=k.parse(f,a)}catch(m){b.j.GH(k,m,g.error,a);return}k.n8(f,a,l,c);var q=null;if(g.add||k.model){e(k,g,c);try{r=!1,-1===d&&(r=!0,d=k.uP()),q=k.yma(l,d,r,g)}catch(s){b.j.GH(k,
s,g.error,a);return}}else if(!c)if(k.tb()){e(k,g,c);var r=!1;-1===d&&(r=!0,d=k.uP());q=k.gta(l,d,r)}else g.DW?k.oS(l,!1,g,!1):k.reset(l,{silent:!0});k.tb()&&q&&(k.lastFetchCount=q.length);k.mc(g.silent?!0:!1,b.ba.N.SYNC,k,f,g);h&&h.call(b.t.Qk(a,k),k,f,g)};return this.M1(g)};b.j.prototype.gta=function(a,b,c){var e;if(a){e=a instanceof Array?a:[a];a={};c&&this.Ct(e.length);c=this.tb();for(var g=null,h=0;h<e.length;h+=1)c&&(a={at:b},g=this.Un(b,null,!0,!1)),a.silent=!0,this.Sn(e[h],a,!0,!1),this.Un(b,
null,!0,!1)!==g&&b++}return e};b.j.prototype.yma=function(a,d,c,e){e=e||{};var g=e.parse,h=b.j.RN(this);if(a){var k=a instanceof Array?a:[a];a={};c&&this.Ct(k.length);c=this.tb();if(e.DW&&!c){for(var f=0;f<k.length;f+=1)d=h&&g?h.parse(k[f]):k[f],k[f]=d;this.oS(k,!1,e,!1)}else{e=null;for(var p=d,f=0;f<k.length;f+=1)d=h&&g?h.parse(k[f]):k[f],c&&(a={at:p},e=this.Un(p,a,!0,!1)),a.silent=!0,this.Sn(d,a,!0,!1),this.Un(p,null,!0,!1)!==e&&p++}}return k};b.j.GH=function(a,d,c,e){b.r.error(d.toString());c&&
c.call(b.t.Qk(e,a),a,d,e)};b.j.prototype.vma=function(a){var d=a||{},c=d.success,e,g;void 0===d.parse&&(d.parse=!0);g=this;d.success=function(h){var k,f,p=null,n=[];try{k=g.parse(h,a)}catch(m){b.j.GH(g,m,d.error,a);return}if(d.add||g.model)if(f=b.j.RN(g),k)for(p=k instanceof Array?k:[k],k=0;k<p.length;k+=1){if(f&&d.parse)try{e=f.parse(p[k])}catch(q){b.j.GH(g,q,d.error,a);return}else e=p[k];n.push(g.iB(e))}g.mc(!1,b.ba.N.SYNC,g,h,d);c&&c.call(b.t.Qk(a,g),g,n,d)};this.M1(d)};b.j.prototype.M1=function(a){try{return b.t.OA("read",
this,a)}catch(d){throw b.t.YB(this,!1,a,null,d,null),d;}};b.j.prototype.bS=function(){var a=this.totalResults;void 0!==a&&this.Vd()!==a&&(this.Mt(Array(a),!0),this.HB(),this.Pm())};b.j.prototype.Bm=function(a){a=a||{};return a[b.j.Oe]||this[b.j.Oe]};b.j.prototype.tb=function(){return-1<this.Bm(null)};b.j.prototype.vG=function(a,d,c,e,g){a=parseInt(b.j.uG(a,d,c),10);return void 0===a||null===a||isNaN(a)?e?e:g:a};b.j.prototype.g0=function(a){return-1===a?void 0:a};b.j.prototype.n8=function(a,d,c,e){var g=
{};this.customPagingOptions&&((g=this.customPagingOptions.call(this,a))||(g={}));d=d||{};this.lastFetchSize=this.vG(g,a,"limit",d.fetchSize,this.fetchSize);this.offset=this.vG(g,a,"offset",d.startIndex,0);this.lastFetchCount=this.vG(g,a,"count",this.lastFetchCount,this.lastFetchCount);this.totalResults=this.g0(this.vG(g,a,"totalResults",this.totalResults,this.totalResults));this.hasMore=this.una(b.j.uG(g,a,"hasMore"),this.offset,this.lastFetchSize,this.totalResults);e||(this.totalResults=this.Mia(this.g0(parseInt(b.j.uG(g,
a,"totalResults"),10)),this.hasMore,this.offset,parseInt(b.j.uG(g,a,"count"),10),c&&Array.isArray(c)?c.length:0));!this.tb()&&this.totalResults&&this.totalResults!==this.lastFetchCount&&this.lastFetchSize&&this.oK(this.lastFetchSize)};b.j.prototype.Mia=function(a,b,c,e,g){return!b&&isNaN(a)?(isNaN(e)?g:e)+c:this.totalResults};b.j.prototype.una=function(a,d,c,e){return b.j.Zn(a)?a:void 0===e||null===e?!0:d+c>e?!1:!0};b.j.uG=function(a,b,c){return a.hasOwnProperty(c)?a[c]:b?b[c]:void 0};b.j.prototype.uP=
function(){return b.j.Zn(this.offset)?this.offset:0};b.j.prototype.create=function(a,d){function c(d,c){d.save(a instanceof b.t?null:a,c);return d}function e(a,b){if(d.wait){if(g.tb()||h)return g.df(function(){return Promise.resolve(void 0)})}else return g.add(a,b)}var g=this;d=d||{};var h=this.Qg(d),k=this.iB(a,d,!1),f=d.success,p=d.context;d.context=this;d.success=function(a,b,c){c.xhr&&(d.xhr=c.xhr);d.wait&&g.add(k,d);f&&f.call(null!=p?p:g,a,b,d)};if(null==k)return!1;d.forceNew=null!=k.wh();var n=
b.t.Qs(d);k.Yy(this);if(h||this.tb())return new Promise(function(a){n.merge=!0;n.deferred=!0;e(k,n).then(function(){d.success=function(b,c,e){e.xhr&&(d.xhr=e.xhr);d.wait?(g.tb()&&(n.force=!0),g.add(k,n).then(function(){f&&f.call(null!=p?p:g,b,c,d);a(b)})):(f&&f.call(null!=p?p:g,b,c,d),a(b))};var b=c(k,d);b||a(b)})});n.merge=!0;e(k,n);return c(k,d)};b.b.g("Collection.prototype.create",{create:b.j.prototype.create});b.j.prototype.Nca=function(a){var b=[],c;this.Yg("pluck");for(c=0;c<this.hf();c+=1)b.push(this.at(c).get(a));
return b};b.b.g("Collection.prototype.pluck",{Nca:b.j.prototype.Nca});b.j.prototype.mea=function(a,b){return this.HA(this.dC(a,b))};b.b.g("Collection.prototype.where",{mea:b.j.prototype.mea});b.j.prototype.dC=function(a,d){d=d||{};var c=this.Qg(d),e=this;if(this.tb())return new Promise(function(c,g){e.vma({query:a,all:!0,success:function(a,b){c(b)},error:function(a,c,h){g(b.j.cA(a,c,h,e,d))}})});var g=[],h,k;for(h=0;h<this.hf();h+=1)k=this.at(h),k.zea(a)&&g.push(k);return c?new Promise(function(a){a(g)}):
g};b.j.prototype.nea=function(a,d){d=d||{};var c=this.Qg(d),e=this;if(this.tb()||c)return e.df(function(){return new Promise(function(b,c){return e.dC(a,d).then(function(a){a=e.Q5(a);b(a)},function(a){c(a)})})});c=this.dC(a,d);c=this.Q5(c);c[b.j.Oe]=-1;c.Pm();return c};b.b.g("Collection.prototype.whereToCollection",{nea:b.j.prototype.nea});b.j.prototype.Q5=function(a){var b=this.r0(!1);b.Mt(a,!1);b.HB();b.Pm();return b};b.j.prototype.Yg=function(a){if(this.tb())throw Error(a+" not valid on a virtual Collection");
};b.j.prototype.map=function(a,b){var c=[],e;this.Yg("map");this.qd().forEach(function(g){e=a.call(b||this,g);c.push(e)});return c};b.b.g("Collection.prototype.map",{map:b.j.prototype.map});b.j.prototype.each=function(a,b){this.Yg("each");this.qd().forEach(a,b)};b.b.g("Collection.prototype.each",{each:b.j.prototype.each});b.j.prototype.size=function(){return this.hf()};b.b.g("Collection.prototype.size",{size:b.j.prototype.size});b.j.prototype.Ida=function(a,d){var c=[],e;this.Yg("sortBy");this.qd().forEach(function(a){c.push(a)});
e=this;c.sort(function(c,h){var k,l;if(f.isFunction(a))return k=a.call(d||e,c),l=a.call(d||e,h),b.j.Wn(k,l,e.sortDirection);k=c.get(a);l=h.get(a);return b.j.Wn(k,l,e.sortDirection)});return c};b.b.g("Collection.prototype.sortBy",{Ida:b.j.prototype.Ida});b.j.prototype.Zaa=function(a,b){var c={},e;this.Yg("groupBy");this.qd().forEach(function(g){e=f.isFunction(a)?a.call(b||this,g):g.get(a);void 0===c[e]&&(c[e]=[]);c[e].push(g)},this);return c};b.b.g("Collection.prototype.groupBy",{Zaa:b.j.prototype.Zaa});
b.j.prototype.Eba=function(a,b){var c={},e;this.Yg("indexBy");this.qd().forEach(function(g){e=f.isFunction(a)?a.call(b||this,g):g.get(a);c[e]=g},this);return c};b.b.g("Collection.prototype.indexBy",{Eba:b.j.prototype.Eba});b.j.prototype.min=function(a,b){var c={},e,g;this.Yg("min");if(0==this.Vd())return null;c=this.sc(0);e=a.call(b||this,this.sc(0));this.qd().forEach(function(h,k){1<=k&&(g=a.call(b||this,h),g<e&&(c=h,e=g))},this);return c};b.b.g("Collection.prototype.min",{min:b.j.prototype.min});
b.j.prototype.max=function(a,b){var c={},e,g;this.Yg("max");if(0==this.Vd())return null;c=this.sc(0);e=a.call(b,this.sc(0));this.qd().forEach(function(h,k){1<=k&&(g=a.call(b||this,h),g>e&&(c=h,e=g))},this);return c};b.b.g("Collection.prototype.max",{max:b.j.prototype.max});b.j.prototype.filter=function(a,b){var c=[];this.Yg("filter");this.qd().forEach(function(e){a.call(b||this,e)&&c.push(e)});return c};b.b.g("Collection.prototype.filter",{filter:b.j.prototype.filter});b.j.prototype.oea=function(a){var b=
[],c,e,g,h;this.Yg("without");for(var k,f=0;f<this.qd().length;f++){h=!0;k=this.sc(f);for(c=0;c<arguments.length;c+=1)if(g=arguments[c].bs(),e=arguments[c].wh(),k.hs(e,g)){h=!1;break}h&&b.push(k)}return b};b.b.g("Collection.prototype.without",{oea:b.j.prototype.oea});b.j.prototype.F$=function(a){var b=[],c,e,g,h,k;this.Yg("difference");for(var f,p=0;p<this.qd().length;p++){k=!0;f=this.sc(p);for(c=0;c<arguments.length;c+=1){for(e=0;e<arguments[c].length;e++)if(h=arguments[c][e].bs(),g=arguments[c][e].wh(),
f.hs(g,h)){k=!1;break}if(!k)break}k&&b.push(f)}return b};b.b.g("Collection.prototype.difference",{F$:b.j.prototype.F$});b.j.prototype.ih=function(){return 0===this.hf()};b.b.g("Collection.prototype.isEmpty",{ih:b.j.prototype.ih});b.j.prototype.R9=function(a,b){this.Yg("any");for(var c,e=0;e<this.Vd();e+=1)if(c=this.sc(e),a.call(b||this,c))return!0;return!1};b.b.g("Collection.prototype.any",{R9:b.j.prototype.R9});b.j.prototype.N$=function(a,b){var c=this.Qg(b),e=this;if(this.tb()||c)return this.df(function(){return new Promise(function(c){e.dC(a,
b).then(function(a){a&&0<a.length&&c(a[0]);c(null)})})});c=this.dC(a,b);return 0<c.length?c[0]:null};b.b.g("Collection.prototype.findWhere",{N$:b.j.prototype.N$});b.j.prototype.slice=function(a,b,c){var e=this.Qg(c);c=[];if(void 0===b){if(this.tb()&&!this.st())throw Error("End must be set for virtual collections with no totalResults");b=this.Vd()}if(e||this.tb()){var g=this;return this.df(function(){return g.hv(a,b)})}for(e=a;e<b;e+=1)c.push(this.sc(e));return c};b.b.g("Collection.prototype.slice",
{slice:b.j.prototype.slice});b.j.prototype.set=function(a,b){return this.oS(a,!0,b,this.Qg(b)||this.tb())};b.b.g("Collection.prototype.set",{set:b.j.prototype.set});b.j.d7=function(a,b,c,e,g){if(c)for(c=b.length-1;0<=c;c-=1)-1==e.indexOf(c)&&a.Kt(b[c],c,g)};b.j.prototype.$va=function(a,b,c,e){if(this.IG()||!c||!e)return{index:a,rW:!1};c=this.Vd();if(a>=c||b>=c)return{index:a,rW:!1};c=this.sc(a);e=this.sc(b);this.QH(a,e);e.Zy(a);this.QH(b,c);c.Zy(b);return{index:b,rW:b!==a}};b.j.prototype.oS=function(a,
d,c,e){c=c||{};var g=void 0===c.add?!0:c.add,h=void 0===c.remove?!0:c.remove,k=void 0===c.merge?!0:c.merge,f=[],p=null,n;d&&(a=this.parse(a));n=Array.isArray(a)?a:[a];if(e){var m=this;return this.df(function(){return m.xla(n,m.qd(),c,h,g,k)})}d=!1;for(a=0;a<n.length;a+=1)if(p=this.C9(this.iB(n[a],c,!0),g,k,e),-1!==p){var p=this.$va(p,a,h,g),q=p.index;p.rW&&(d=!0);-1===f.indexOf(q)&&f.push(q)}d&&this.mc(c.silent,b.ba.N.SORT,this,c.add?{add:!0}:null,null);b.j.d7(this,this.qd(),h,f,c)};b.j.prototype.xla=
function(a,d,c,e,g,h){var k=[],f,p=this;return new Promise(function(n,m){function q(b){return new Promise(function(d,e){p.C9(p.iB(a[b],c,!0),g,h,!0).then(function(a){-1!==a&&k.push(a);d(b+1)},e)})}var s=Promise.resolve(0);for(f=0;f<a.length;f+=1)s=s.then(q);s.then(function(){b.j.d7(p,d,e,k,c);n(void 0)},m)})};b.j.prototype.C9=function(a,b,c,e){function g(g,e,h){var k=e?e.index:-1;if(e&&e.m){if(c){var f={merge:c};if(h)return new Promise(function(b){g.Sn(a,f,!1,!0).then(function(){b(k)})});g.add(a,
f)}}else if(b){if(h)return new Promise(function(b){g.Sn(a,f,!1,!0).then(function(){b(g.hf()-1)})});g.add(a);k=g.hf()-1}return k}if(e||this.tb()){var h=this;return new Promise(function(b){h.jj(a,{silent:!0},e).then(function(a){g(h,a,!0).then(function(a){b(a)})})})}var k=this.jj(a);return g(this,k,!1)};b.j.prototype.toJSON=function(){var a=[];this.Yg("toJSON");this.qd().forEach(function(b){a.push(b.toJSON())});return a};b.b.g("Collection.prototype.toJSON",{toJSON:b.j.prototype.toJSON});b.j.prototype.first=
function(a,b){var c=this.Qg(b),e=this.hf(),g=[];a?e=a:a=1;c=this.tb()||c;if(1===a){if(c){var h=this;return this.df(function(){return h.bO(0,null)})}return 0<this.Vd()?this.sc(0):null}e>this.Vd()&&(!this.tb()||this.st())&&(e=this.Vd());if(c)return h=this,this.df(function(){return h.hv(0,e)});for(c=0;c<e;c+=1)g.push(this.sc(c));return g};b.b.g("Collection.prototype.first",{first:b.j.prototype.first});b.j.prototype.indexOf=function(a,b){var c=this.Qg(b);if(this.tb()||c){var e=this;return this.df(function(){return e.jj(a,
null,!0).then(function(a){return a.index})})}return this.jj(a).index};b.b.g("Collection.prototype.indexOf",{indexOf:b.j.prototype.indexOf});b.j.prototype.contains=function(a,b){var c=this.Qg(b);if(this.tb()||c){var e=this;return this.df(function(){return e.jj(a,null,!0).then(function(a){return-1<a.index})})}return-1<this.jj(a).index};b.b.g("Collection.prototype.contains",{contains:b.j.prototype.contains});b.j.prototype.Dba=b.j.prototype.contains;b.b.g("Collection.prototype.include",{Dba:b.j.prototype.Dba});
b.j.prototype.Lra=function(a){a=this.W2(a);return void 0!==a?a.index:-1};b.j.prototype.pop=function(a){var b=this.Qg(a);if(this.tb()||b){var c=this;return this.at(this.hf()-1,{deferred:b}).then(function(b){c.remove(b,a);return b})}b=this.at(this.hf()-1);this.remove(b,a);return b};b.b.g("Collection.prototype.pop",{pop:b.j.prototype.pop});b.j.prototype.push=function(a,b){var c=this.Qg(b);this.Ct(1);return this.HA(this.Sn(a,b,!1,c))};b.b.g("Collection.prototype.push",{push:b.j.prototype.push});b.j.prototype.lastIndexOf=
function(a,d){var c;this.Yg("lastIndexOf");void 0===d&&(d=0);for(c=this.hf()-1;c>=d;c-=1)if(b.b.Az(a,this.at(c)))return c;return-1};b.b.g("Collection.prototype.lastIndexOf",{lastIndexOf:b.j.prototype.lastIndexOf});b.j.prototype.A3=function(a){return void 0===a?[]:a.split(",")};b.j.doa=function(a){a=Array.isArray(a)?a:[a];var d="",c,e,g,h;for(g=0;g<a.length;g++){c=a[g];for(h in c)if(c.hasOwnProperty(h))for(var k=Array.isArray(c[h])?c[h]:[c[h]],l=0;l<k.length;l++){if(b.t.gX(k[l])){e=k[l].value;var p=
null,p=k[l].comparator,p=f.isFunction(p)?p(null,h,e):p;e=h+p+e}else e=h+"\x3d"+c[h];d+=e+"+"}d=d.substring(0,d.length-1)+","}return","===d.substring(d.length-1)?d.substring(0,d.length-1):d};b.j.prototype.efa=function(a){var d={},c;for(c in a)a.hasOwnProperty(c)&&(d[c]=a[c]);if((a=this.comparator)&&b.Ra.oe(a)){a=this.A3(a);for(c=0;c<a.length;c++)d.sort=0===c?a[c]:d.sort+(","+a[c]);d.sortDir=this.C3()}this.tb()&&(d[b.j.Oe]=this.Bm(d));return d};b.j.prototype.Sea=function(){if(f.isFunction(this.customURL))return!0;
var a=this.$W(null);return b.j.Zn(a)};b.j.prototype.$W=function(a){var d=b.t.Fp(this,"url");if(this.tb()){var c=a.all,e=null;e=c?(e=this.totalResults)?e:this.Bm(a):this.Bm(a);d=d&&-1<d.indexOf("?")?d+"\x26":d+"?";d+="limit\x3d"+e;c||(b.j.Zn(a.startIndex)&&(d+="\x26offset\x3d"+a.startIndex),a.startID&&(d+="\x26fromID\x3d"+a.startID),a.since&&(d+="\x26since\x3d"+a.since),a.until&&(d+="\x26until\x3d"+a.until));a.query&&(a=b.j.doa(a.query))&&0<a.length&&(d+="\x26q\x3d"+a);if((a=this.comparator)&&b.Ra.oe(a))for(a=
this.A3(a),c=this.C3(),e=0;e<a.length;e++)d=0===e?d+("\x26orderBy\x3d"+a[e]+":"+c):d+(","+a[e]+":"+c);d+="\x26totalResults\x3dtrue"}return d};b.j.prototype.C3=function(){return-1===this.sortDirection?"desc":"asc"};b.j.prototype.sync=function(a,b,c){return window.oj.sync(a,b,c)};b.j.Oe="fetchSize"});